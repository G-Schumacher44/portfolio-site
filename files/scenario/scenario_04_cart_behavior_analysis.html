<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Scenario: Cart & Customer Behavior Analysis</title>
  <style>
    :root {
      --bg: #0c0d10;
      --card: #14161a;
      --text: #e9edf1;
      --muted: #a7b0bb;
      --brand: #69c;
      --line: #22262c;
      --code-bg: #1e293b; /* slate-800 */
      --note-bg: rgba(102, 153, 204, 0.1);
      --note-border: rgba(102, 153, 204, 0.3);
    }
    html, body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background-image: url('../../img/logos/dark_light_logo_centered.png');
      background-repeat: repeat-y;
      background-size: auto;
      background-position: top center;
      line-height: 1.7;
    }
    a {
      color: var(--brand);
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    main {
      max-width: 800px;
      margin: 40px auto;
      padding: 20px 40px;
      background: rgba(20, 22, 26, 0.8);
      border: 1px solid var(--line);
      border-radius: 16px;
      backdrop-filter: blur(5px);
    }
    h1, h2, h3 {
      color: var(--text);
      font-weight: 600;
      border-bottom: 1px solid var(--line);
      padding-bottom: 8px;
      margin-bottom: 16px;
    }
    h1 { font-size: 2rem; margin-top: 0; }
    h2 { font-size: 1.5rem; margin-top: 32px; }
    h3 { font-size: 1.25rem; }
    p {
      color: var(--muted);
      margin: 0 0 1em;
    }
    strong {
      color: var(--text);
      font-weight: 600;
    }
    em {
      color: var(--brand);
      font-style: normal;
    }
    ul {
      padding-left: 20px;
      margin-bottom: 1em;
    }
    li {
      margin-bottom: 0.5em;
      color: var(--muted);
    }
    code {
      background: var(--code-bg);
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Fira Code', 'Dank Mono', monospace;
      font-size: 0.9em;
      color: var(--brand);
    }
    hr {
      border: 0;
      border-top: 1px solid var(--line);
      margin: 2em 0;
    }
    .note {
      font-size: 0.9em;
      color: var(--muted);
      margin-top: -0.5em;
    }
    .analytical-note {
      background: var(--note-bg);
      border-left: 4px solid var(--note-border);
      padding: 1em 1.5em;
      margin: 2em 0;
      border-radius: 0 8px 8px 0;
    }
    .analytical-note > p {
      margin: 0;
    }
    .scenario-footer {
      text-align: center;
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid var(--line);
      font-size: 0.9em;
    }
    .scenario-footer p {
      margin-bottom: 0.5em;
    }
  </style>
</head>
<body>
  <main>
    <a href="../../index.html#sql-stories" style="display:inline-block; margin-bottom: 24px;">&larr; Back to Portfolio</a>
    
    <h1>🛒 Scenario 04: Cart & Customer Behavior Analysis</h1>

    <h2>🧭 Background</h2>
    <p>As acquisition scales, leadership has noticed that <strong>a large share of revenue is lost at the cart stage</strong>. Customers add products, but many never convert—and there’s little visibility into why. With new cart data available, the Growth & Retention team wants to understand <strong>who abandons, what they abandon, and which customers are most likely to re-engage</strong>.</p>
    <p>This scenario pushes beyond descriptive inventory/retention audits into <strong>behavioral analysis</strong>, where business rules and assumptions must be made explicit (e.g., what counts as a “converted cart,” how to link carts to orders, what time windows to use).</p>

    <hr>

    <h2>🧑‍💼 Stakeholder</h2>
    <p><strong>Name:</strong> Director of Growth & Retention<br>
    <strong>Objective:</strong> Reduce abandonment, recover lost revenue, and guide re-engagement campaigns based on real customer behavior.</p>

    <hr>

    <h2>🎯 Business Objective</h2>
    <p>Build a SQL-driven diagnostic that:</p>
    <ul>
      <li>Maps the <strong>cart funnel</strong> (open → converted vs abandoned) over time.</li>
      <li>Quantifies the <strong>value left behind in abandoned carts</strong> and identifies top SKUs/categories driving that leakage.</li>
      <li>Segments cart behavior by <strong>customer attributes</strong> (signup channel, loyalty tier, CLV bucket).</li>
      <li>Measures <strong>re-engagement</strong> (orders placed within 7 days of abandonment) to surface “savable” customers.</li>
      <li>Analyzes <strong>time-to-order</strong> for converted carts to understand purchase lag.</li>
    </ul>

    <hr>

    <h2>🧩 Available Data</h2>
    <ul>
      <li><code>shopping_carts</code> → <code>cart_id</code>, <code>customer_id</code>, <code>created_at</code>, <code>status</code></li>
      <li class="note" style="list-style: none; margin-left: -15px;"><em>(normalize with <code>LOWER(TRIM(status))</code> to handle case variants)</em></li>
      <li><code>cart_items</code> → <code>cart_id</code>, <code>product_id</code>, <code>quantity</code>, <code>unit_price</code></li>
      <li class="note" style="list-style: none; margin-left: -15px;"><em>(dedupe on <code>(cart_id, product_id)</code> when aggregating SKUs)</em></li>
      <li><code>customers</code> → <code>customer_id</code>, <code>signup_channel</code>, <code>loyalty_tier</code>, <code>clv_bucket</code>, <code>signup_date</code></li>
      <li><code>orders</code> → <code>order_id</code>, <code>customer_id</code>, <code>order_date</code></li>
      <li><code>product_catalog</code> → product attributes for SKU/category rollups</li>
    </ul>

    <hr>

    <h2>🛠️ Key Metrics</h2>
    <ul>
      <li><strong>Cart Conversion Rate</strong> = converted ÷ total carts</li>
      <li><strong>Abandonment Rate</strong> = abandoned ÷ total carts</li>
      <li><strong>Abandoned Cart Value</strong> = Σ(quantity × unit_price) for abandoned carts</li>
      <li><strong>Top Abandoned SKUs / Categories</strong> by value left</li>
      <li><strong>Re-engagement Rate (7d)</strong> = % of customers with abandoned carts who place an order ≤7 days later</li>
      <li><strong>Time-to-Order (converted)</strong> = days from cart creation → first order</li>
    </ul>
    <p class="note"><strong>🛠 Note on Data Source:</strong><br>
    This diagnostic uses <code>ecom_retailer_v3.db</code>, a simulated ecommerce dataset with behaviorally plausible customer patterns. All cohorts and metrics are fully reproducible for learning purposes.</p>

    <blockquote class="analytical-note">
      <p>✍️ <strong>Analytical Framing:</strong><br>
      This scenario introduces cohort grouping, temporal analysis, segmentation, and churn proxy signals—ideal for building intermediate SQL and customer analytics skills.</p>
    </blockquote>

    <footer class="scenario-footer">
      <p>
        <a href="../README.md" target="_blank" rel="noopener">🏠 <b>Main README</b></a>
        &nbsp;·&nbsp;
        <a href="../USAGE.md" target="_blank" rel="noopener">📖 <b>Usage Guide</b></a>
        &nbsp;·&nbsp;
        <a href="../story_01_inventory_audit/story_01_portfolio_readme.md" target="_blank" rel="noopener">📦 <b>Case Study: Inventory Audit</b></a>
        &nbsp;·&nbsp;
        <a href="./story_02_portfolio_readme.md" target="_blank" rel="noopener">💡 <b>Case Study: Customer Retention</b></a>
      </p>
      <p><sub>✨ SQL · Python · Storytelling ✨</sub></p>
    </footer>

  </main>
</body>
</html>