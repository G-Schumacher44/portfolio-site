{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-01-26T01:20:33.540579Z", "invocation_id": "f7a3ad0c-a45c-400a-8874-7fb48f5a195e", "invocation_started_at": "2026-01-26T01:20:31.895580Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.071128Z", "completed_at": "2026-01-26T01:20:33.080679Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.084082Z", "completed_at": "2026-01-26T01:20:33.084086Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014003992080688477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__cart_items", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_cart_items_scored as (\n\n\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/cart_items/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ndim_shopping_carts as (\n    select distinct\n        \n    case\n        when lower(trim(cart_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(cart_id)\n    end as cart_id\n    from read_parquet('data/bronze/shopping_carts/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where \n    case\n        when lower(trim(cart_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(cart_id)\n    end is not null\n),\n\ndim_products as (\n    select distinct\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id\n    from read_parquet('data/silver/dims/product_catalog/**/*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n      and \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) is not null\n),\n\ncleaned as (\n    select\n        \n    try_cast(\n        case\n            when lower(trim(cart_item_id::varchar)) in ('', 'none', 'null') then null\n            else cart_item_id\n        end as bigint\n    ) as cart_item_id,\n        \n    case\n        when lower(trim(cart_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(cart_id)\n    end as cart_id,\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id,\n        \n    case\n        when lower(trim(product_name)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(product_name)\n    end as product_name,\n        \n    case\n        when lower(trim(category)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(category))\n    end as category,\n        \n    try_cast(\n        case\n            when lower(trim(added_at::varchar)) in ('', 'none', 'null') then null\n            else trim(added_at::varchar)\n        end as timestamp\n    ) as added_at,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    try_cast(\n        case\n            when lower(trim(quantity::varchar)) in ('', 'none', 'null') then null\n            else quantity\n        end as bigint\n    ) as quantity,\n        \n    try_cast(\n        case\n            when lower(trim(unit_price::varchar)) in ('', 'none', 'null') then null\n            else unit_price\n        end as decimal(18, 2)\n    ) as unit_price,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingest_dt as date) as ingestion_dt,\n        cast(\n    try_cast(\n        case\n            when lower(trim(added_at::varchar)) in ('', 'none', 'null') then null\n            else trim(added_at::varchar)\n        end as timestamp\n    ) as date) as added_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        dim_shopping_carts.cart_id is not null as cart_fk_valid,\n        dim_products.product_id is not null as product_fk_valid,\n        row_number() over (\n            partition by cleaned.cart_id, cleaned.product_id, cleaned.added_at\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n    left join dim_shopping_carts\n        on cleaned.cart_id = dim_shopping_carts.cart_id\n    left join dim_products\n        on cleaned.product_id = dim_products.product_id\n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (cart_item_id is not null and cart_item_id > 0)\n            and \n    (cart_id is not null and cart_id != '')\n            and \n    (product_id is not null and product_id > 0)\n            and \n    (quantity is not null and quantity > 0)\n            and \n    (unit_price is not null and unit_price >= 0)\n            and (not False or (cart_id is null or cart_fk_valid))\n            and (not False or (product_id is null or product_fk_valid))\n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when cart_item_id is null or cart_item_id <= 0 then 'invalid_cart_item_id' end,\n            case when not \n    (cart_id is not null and cart_id != '') then 'missing_cart_id' end,\n            case when product_id is null or product_id <= 0 then 'invalid_product_id' end,\n            case when quantity is null or quantity <= 0 then 'invalid_quantity' end,\n            case when unit_price is null then 'missing_unit_price' end,\n            case when unit_price < 0 then 'negative_unit_price' end,\n            \n            case when row_num > 1 then 'duplicate_cart_item_line' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    cart_item_id,\n    cart_id,\n    product_id,\n    product_name,\n    category,\n    added_at,\n    quantity,\n    unit_price,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    added_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    cart_item_id,\n    cart_id,\n    product_id,\n    product_name,\n    category,\n    added_at,\n    quantity,\n    unit_price,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    added_dt\nfrom __dbt__cte__int_cart_items_scored\nwhere is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__cart_items\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.074733Z", "completed_at": "2026-01-26T01:20:33.083888Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.084392Z", "completed_at": "2026-01-26T01:20:33.084396Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013484954833984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__cart_items_quarantine", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_cart_items_scored as (\n\n\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/cart_items/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ndim_shopping_carts as (\n    select distinct\n        \n    case\n        when lower(trim(cart_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(cart_id)\n    end as cart_id\n    from read_parquet('data/bronze/shopping_carts/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where \n    case\n        when lower(trim(cart_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(cart_id)\n    end is not null\n),\n\ndim_products as (\n    select distinct\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id\n    from read_parquet('data/silver/dims/product_catalog/**/*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n      and \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) is not null\n),\n\ncleaned as (\n    select\n        \n    try_cast(\n        case\n            when lower(trim(cart_item_id::varchar)) in ('', 'none', 'null') then null\n            else cart_item_id\n        end as bigint\n    ) as cart_item_id,\n        \n    case\n        when lower(trim(cart_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(cart_id)\n    end as cart_id,\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id,\n        \n    case\n        when lower(trim(product_name)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(product_name)\n    end as product_name,\n        \n    case\n        when lower(trim(category)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(category))\n    end as category,\n        \n    try_cast(\n        case\n            when lower(trim(added_at::varchar)) in ('', 'none', 'null') then null\n            else trim(added_at::varchar)\n        end as timestamp\n    ) as added_at,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    try_cast(\n        case\n            when lower(trim(quantity::varchar)) in ('', 'none', 'null') then null\n            else quantity\n        end as bigint\n    ) as quantity,\n        \n    try_cast(\n        case\n            when lower(trim(unit_price::varchar)) in ('', 'none', 'null') then null\n            else unit_price\n        end as decimal(18, 2)\n    ) as unit_price,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingest_dt as date) as ingestion_dt,\n        cast(\n    try_cast(\n        case\n            when lower(trim(added_at::varchar)) in ('', 'none', 'null') then null\n            else trim(added_at::varchar)\n        end as timestamp\n    ) as date) as added_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        dim_shopping_carts.cart_id is not null as cart_fk_valid,\n        dim_products.product_id is not null as product_fk_valid,\n        row_number() over (\n            partition by cleaned.cart_id, cleaned.product_id, cleaned.added_at\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n    left join dim_shopping_carts\n        on cleaned.cart_id = dim_shopping_carts.cart_id\n    left join dim_products\n        on cleaned.product_id = dim_products.product_id\n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (cart_item_id is not null and cart_item_id > 0)\n            and \n    (cart_id is not null and cart_id != '')\n            and \n    (product_id is not null and product_id > 0)\n            and \n    (quantity is not null and quantity > 0)\n            and \n    (unit_price is not null and unit_price >= 0)\n            and (not False or (cart_id is null or cart_fk_valid))\n            and (not False or (product_id is null or product_fk_valid))\n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when cart_item_id is null or cart_item_id <= 0 then 'invalid_cart_item_id' end,\n            case when not \n    (cart_id is not null and cart_id != '') then 'missing_cart_id' end,\n            case when product_id is null or product_id <= 0 then 'invalid_product_id' end,\n            case when quantity is null or quantity <= 0 then 'invalid_quantity' end,\n            case when unit_price is null then 'missing_unit_price' end,\n            case when unit_price < 0 then 'negative_unit_price' end,\n            \n            case when row_num > 1 then 'duplicate_cart_item_line' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    cart_item_id,\n    cart_id,\n    product_id,\n    product_name,\n    category,\n    added_at,\n    quantity,\n    unit_price,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    added_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    cart_item_id,\n    cart_id,\n    product_id,\n    product_name,\n    category,\n    added_at,\n    quantity,\n    unit_price,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    added_dt,\n    invalid_reason,\n    row_num\nfrom __dbt__cte__int_cart_items_scored\nwhere not is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__cart_items_quarantine\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.077731Z", "completed_at": "2026-01-26T01:20:33.084684Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.085352Z", "completed_at": "2026-01-26T01:20:33.085355Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010854005813598633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__customers", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_customers_scored as (\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/customers/signup_date=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ncleaned as (\n    select\n        \n    case\n        when lower(trim(customer_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(customer_id)\n    end as customer_id,\n        \n    case\n        when lower(trim(email)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(email))\n    end as email,\n        \n    try_cast(\n        case\n            when lower(trim(signup_date::varchar)) in ('', 'none', 'null') then null\n            else trim(signup_date::varchar)\n        end as date\n    ) as signup_date,\n        \n    case\n        when lower(trim(first_name)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(first_name)\n    end as first_name,\n        \n    case\n        when lower(trim(last_name)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(last_name)\n    end as last_name,\n        \n    case\n        when lower(trim(phone_number)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(phone_number)\n    end as phone_number,\n        \n    case\n        when lower(trim(gender)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(gender))\n    end as gender,\n        \n    try_cast(\n        case\n            when lower(trim(age::varchar)) in ('', 'none', 'null') then null\n            else age\n        end as decimal(10, 2)\n    ) as age,\n        \n    try_cast(\n        case\n            when lower(trim(is_guest::varchar)) in ('', 'none', 'null') then null\n            else trim(is_guest::varchar)\n        end as boolean\n    ) as is_guest,\n        \n    case\n        when lower(trim(customer_status)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(customer_status))\n    end as customer_status,\n        \n    case\n        when lower(trim(signup_channel)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(signup_channel))\n    end as signup_channel,\n        \n    case\n        when lower(trim(loyalty_tier)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(loyalty_tier))\n    end as loyalty_tier,\n        \n    case\n        when lower(trim(initial_loyalty_tier)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(initial_loyalty_tier))\n    end as initial_loyalty_tier,\n        \n    try_cast(\n        case\n            when lower(trim(email_verified::varchar)) in ('', 'none', 'null') then null\n            else trim(email_verified::varchar)\n        end as boolean\n    ) as email_verified,\n        \n    try_cast(\n        case\n            when lower(trim(marketing_opt_in::varchar)) in ('', 'none', 'null') then null\n            else trim(marketing_opt_in::varchar)\n        end as boolean\n    ) as marketing_opt_in,\n        \n    case\n        when lower(trim(mailing_address)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(mailing_address)\n    end as mailing_address,\n        \n    case\n        when lower(trim(billing_address)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(billing_address)\n    end as billing_address,\n        \n    try_cast(\n        case\n            when lower(trim(loyalty_enrollment_date::varchar)) in ('', 'none', 'null') then null\n            else trim(loyalty_enrollment_date::varchar)\n        end as date\n    ) as loyalty_enrollment_date,\n        \n    case\n        when lower(trim(clv_bucket)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(clv_bucket))\n    end as clv_bucket,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingestion_ts as date) as ingestion_dt,\n        cast(\n    try_cast(\n        case\n            when lower(trim(signup_date::varchar)) in ('', 'none', 'null') then null\n            else trim(signup_date::varchar)\n        end as date\n    ) as date) as signup_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        row_number() over (\n            partition by cleaned.customer_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (customer_id is not null and customer_id != '')\n            and \n    (email is not null\n     and email like '%@%.%'\n     and length(email) >= 5)\n            and \n    (signup_date is not null)\n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when not \n    (customer_id is not null and customer_id != '') then 'missing_customer_id' end,\n            case when not \n    (email is not null\n     and email like '%@%.%'\n     and length(email) >= 5) then 'invalid_email' end,\n            case when signup_date is null then 'missing_signup_date' end,\n            case when row_num > 1 then 'duplicate_customer_id' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    customer_id,\n    email,\n    signup_date,\n    first_name,\n    last_name,\n    phone_number,\n    gender,\n    age,\n    is_guest,\n    customer_status,\n    signup_channel,\n    loyalty_tier,\n    initial_loyalty_tier,\n    email_verified,\n    marketing_opt_in,\n    mailing_address,\n    billing_address,\n    loyalty_enrollment_date,\n    clv_bucket,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    signup_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    customer_id,\n    email,\n    signup_date,\n    first_name,\n    last_name,\n    phone_number,\n    gender,\n    age,\n    is_guest,\n    customer_status,\n    signup_channel,\n    loyalty_tier,\n    initial_loyalty_tier,\n    email_verified,\n    marketing_opt_in,\n    mailing_address,\n    billing_address,\n    loyalty_enrollment_date,\n    clv_bucket,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    signup_dt\nfrom __dbt__cte__int_customers_scored\nwhere is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.080863Z", "completed_at": "2026-01-26T01:20:33.085625Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.086388Z", "completed_at": "2026-01-26T01:20:33.086390Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00927424430847168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__customers_quarantine", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_customers_scored as (\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/customers/signup_date=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ncleaned as (\n    select\n        \n    case\n        when lower(trim(customer_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(customer_id)\n    end as customer_id,\n        \n    case\n        when lower(trim(email)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(email))\n    end as email,\n        \n    try_cast(\n        case\n            when lower(trim(signup_date::varchar)) in ('', 'none', 'null') then null\n            else trim(signup_date::varchar)\n        end as date\n    ) as signup_date,\n        \n    case\n        when lower(trim(first_name)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(first_name)\n    end as first_name,\n        \n    case\n        when lower(trim(last_name)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(last_name)\n    end as last_name,\n        \n    case\n        when lower(trim(phone_number)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(phone_number)\n    end as phone_number,\n        \n    case\n        when lower(trim(gender)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(gender))\n    end as gender,\n        \n    try_cast(\n        case\n            when lower(trim(age::varchar)) in ('', 'none', 'null') then null\n            else age\n        end as decimal(10, 2)\n    ) as age,\n        \n    try_cast(\n        case\n            when lower(trim(is_guest::varchar)) in ('', 'none', 'null') then null\n            else trim(is_guest::varchar)\n        end as boolean\n    ) as is_guest,\n        \n    case\n        when lower(trim(customer_status)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(customer_status))\n    end as customer_status,\n        \n    case\n        when lower(trim(signup_channel)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(signup_channel))\n    end as signup_channel,\n        \n    case\n        when lower(trim(loyalty_tier)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(loyalty_tier))\n    end as loyalty_tier,\n        \n    case\n        when lower(trim(initial_loyalty_tier)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(initial_loyalty_tier))\n    end as initial_loyalty_tier,\n        \n    try_cast(\n        case\n            when lower(trim(email_verified::varchar)) in ('', 'none', 'null') then null\n            else trim(email_verified::varchar)\n        end as boolean\n    ) as email_verified,\n        \n    try_cast(\n        case\n            when lower(trim(marketing_opt_in::varchar)) in ('', 'none', 'null') then null\n            else trim(marketing_opt_in::varchar)\n        end as boolean\n    ) as marketing_opt_in,\n        \n    case\n        when lower(trim(mailing_address)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(mailing_address)\n    end as mailing_address,\n        \n    case\n        when lower(trim(billing_address)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(billing_address)\n    end as billing_address,\n        \n    try_cast(\n        case\n            when lower(trim(loyalty_enrollment_date::varchar)) in ('', 'none', 'null') then null\n            else trim(loyalty_enrollment_date::varchar)\n        end as date\n    ) as loyalty_enrollment_date,\n        \n    case\n        when lower(trim(clv_bucket)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(clv_bucket))\n    end as clv_bucket,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingestion_ts as date) as ingestion_dt,\n        cast(\n    try_cast(\n        case\n            when lower(trim(signup_date::varchar)) in ('', 'none', 'null') then null\n            else trim(signup_date::varchar)\n        end as date\n    ) as date) as signup_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        row_number() over (\n            partition by cleaned.customer_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (customer_id is not null and customer_id != '')\n            and \n    (email is not null\n     and email like '%@%.%'\n     and length(email) >= 5)\n            and \n    (signup_date is not null)\n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when not \n    (customer_id is not null and customer_id != '') then 'missing_customer_id' end,\n            case when not \n    (email is not null\n     and email like '%@%.%'\n     and length(email) >= 5) then 'invalid_email' end,\n            case when signup_date is null then 'missing_signup_date' end,\n            case when row_num > 1 then 'duplicate_customer_id' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    customer_id,\n    email,\n    signup_date,\n    first_name,\n    last_name,\n    phone_number,\n    gender,\n    age,\n    is_guest,\n    customer_status,\n    signup_channel,\n    loyalty_tier,\n    initial_loyalty_tier,\n    email_verified,\n    marketing_opt_in,\n    mailing_address,\n    billing_address,\n    loyalty_enrollment_date,\n    clv_bucket,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    signup_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    customer_id,\n    email,\n    signup_date,\n    first_name,\n    last_name,\n    phone_number,\n    gender,\n    age,\n    is_guest,\n    customer_status,\n    signup_channel,\n    loyalty_tier,\n    initial_loyalty_tier,\n    email_verified,\n    marketing_opt_in,\n    mailing_address,\n    billing_address,\n    loyalty_enrollment_date,\n    clv_bucket,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    signup_dt,\n    invalid_reason,\n    row_num\nfrom __dbt__cte__int_customers_scored\nwhere not is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__customers_quarantine\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.090552Z", "completed_at": "2026-01-26T01:20:33.099684Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.100046Z", "completed_at": "2026-01-26T01:20:33.100049Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014097929000854492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__orders_quarantine", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_orders_scored as (\n\n\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/orders/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\n\n\ncleaned as (\n    select\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id,\n        \n    case\n        when lower(trim(customer_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(customer_id)\n    end as customer_id,\n        \n    try_cast(\n        case\n            when lower(trim(order_date::varchar)) in ('', 'none', 'null') then null\n            else trim(order_date::varchar)\n        end as timestamp\n    ) as order_date,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    try_cast(\n        case\n            when lower(trim(total_items::varchar)) in ('', 'none', 'null') then null\n            else total_items\n        end as bigint\n    ) as total_items,\n        \n    try_cast(\n        case\n            when lower(trim(gross_total::varchar)) in ('', 'none', 'null') then null\n            else gross_total\n        end as decimal(18, 2)\n    ) as gross_total,\n        \n    try_cast(\n        case\n            when lower(trim(net_total::varchar)) in ('', 'none', 'null') then null\n            else net_total\n        end as decimal(18, 2)\n    ) as net_total,\n        \n    try_cast(\n        case\n            when lower(trim(total_discount_amount::varchar)) in ('', 'none', 'null') then null\n            else total_discount_amount\n        end as decimal(18, 2)\n    ) as total_discount_amount,\n        \n    try_cast(\n        case\n            when lower(trim(shipping_cost::varchar)) in ('', 'none', 'null') then null\n            else shipping_cost\n        end as decimal(18, 2)\n    ) as shipping_cost,\n        \n    try_cast(\n        case\n            when lower(trim(actual_shipping_cost::varchar)) in ('', 'none', 'null') then null\n            else actual_shipping_cost\n        end as decimal(18, 2)\n    ) as actual_shipping_cost,\n        \n    try_cast(\n        case\n            when lower(trim(payment_processing_fee::varchar)) in ('', 'none', 'null') then null\n            else payment_processing_fee\n        end as decimal(18, 2)\n    ) as payment_processing_fee,\n        \n    try_cast(\n        case\n            when lower(trim(is_expedited::varchar)) in ('', 'none', 'null') then null\n            else trim(is_expedited::varchar)\n        end as boolean\n    ) as is_expedited,\n        \n    try_cast(\n        case\n            when lower(trim(is_reactivated::varchar)) in ('', 'none', 'null') then null\n            else trim(is_reactivated::varchar)\n        end as boolean\n    ) as is_reactivated,\n        \n    case\n        when lower(trim(email)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(email))\n    end as email,\n        \n    case\n        when lower(trim(order_channel)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(order_channel))\n    end as order_channel,\n        \n    case\n        when lower(trim(customer_tier)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(customer_tier))\n    end as customer_tier,\n        \n    case\n        when lower(trim(payment_method)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(payment_method))\n    end as payment_method,\n        \n    case\n        when lower(trim(shipping_speed)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(shipping_speed))\n    end as shipping_speed,\n        \n    case\n        when lower(trim(clv_bucket)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(clv_bucket))\n    end as clv_bucket,\n        \n    case\n        when lower(trim(agent_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(agent_id)\n    end as agent_id,\n        \n    case\n        when lower(trim(shipping_address)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(shipping_address)\n    end as shipping_address,\n        \n    case\n        when lower(trim(billing_address)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(billing_address)\n    end as billing_address,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingest_dt as date) as ingestion_dt,\n        coalesce(\n            cast(\n    try_cast(\n        case\n            when lower(trim(order_date::varchar)) in ('', 'none', 'null') then null\n            else trim(order_date::varchar)\n        end as timestamp\n    ) as date),\n            cast(\n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as date)\n        ) as order_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        \n        true as customer_fk_valid,\n        \n        row_number() over (\n            partition by cleaned.order_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n    \n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (order_id is not null and order_id != '')\n            and \n    (customer_id is not null and customer_id != '')\n            and \n    (order_date is not null)\n            and \n    (gross_total is not null and gross_total >= 0)\n            and \n    (net_total is not null and net_total >= 0)\n            and (total_discount_amount is null or total_discount_amount >= 0)\n            and (net_total <= gross_total or gross_total is null or net_total is null)\n            \n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when not \n    (order_id is not null and order_id != '') then 'missing_order_id' end,\n            case when not \n    (customer_id is not null and customer_id != '') then 'missing_customer_id' end,\n            case when not \n    (order_date is not null) then 'invalid_order_date' end,\n            case when gross_total is null then 'missing_gross_total' end,\n            case when net_total is null then 'missing_net_total' end,\n            case when gross_total < 0 then 'negative_gross_total' end,\n            case when net_total < 0 then 'negative_net_total' end,\n            case when total_discount_amount < 0 then 'negative_discount' end,\n            case when net_total > gross_total and gross_total is not null and net_total is not null\n                 then 'net_exceeds_gross' end,\n            \n            case when row_num > 1 then 'duplicate_order_id' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    order_id,\n    total_items,\n    order_date,\n    customer_id,\n    email,\n    order_channel,\n    is_expedited,\n    customer_tier,\n    gross_total,\n    net_total,\n    total_discount_amount,\n    payment_method,\n    shipping_speed,\n    shipping_cost,\n    agent_id,\n    actual_shipping_cost,\n    payment_processing_fee,\n    shipping_address,\n    billing_address,\n    clv_bucket,\n    is_reactivated,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    order_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    order_id,\n    total_items,\n    order_date,\n    customer_id,\n    email,\n    order_channel,\n    is_expedited,\n    customer_tier,\n    gross_total,\n    net_total,\n    total_discount_amount,\n    payment_method,\n    shipping_speed,\n    shipping_cost,\n    agent_id,\n    actual_shipping_cost,\n    payment_processing_fee,\n    shipping_address,\n    billing_address,\n    clv_bucket,\n    is_reactivated,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    order_dt,\n    invalid_reason,\n    row_num\nfrom __dbt__cte__int_orders_scored\nwhere not is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__orders_quarantine\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.087439Z", "completed_at": "2026-01-26T01:20:33.099869Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.100513Z", "completed_at": "2026-01-26T01:20:33.100516Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014755725860595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__orders", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_orders_scored as (\n\n\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/orders/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\n\n\ncleaned as (\n    select\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id,\n        \n    case\n        when lower(trim(customer_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(customer_id)\n    end as customer_id,\n        \n    try_cast(\n        case\n            when lower(trim(order_date::varchar)) in ('', 'none', 'null') then null\n            else trim(order_date::varchar)\n        end as timestamp\n    ) as order_date,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    try_cast(\n        case\n            when lower(trim(total_items::varchar)) in ('', 'none', 'null') then null\n            else total_items\n        end as bigint\n    ) as total_items,\n        \n    try_cast(\n        case\n            when lower(trim(gross_total::varchar)) in ('', 'none', 'null') then null\n            else gross_total\n        end as decimal(18, 2)\n    ) as gross_total,\n        \n    try_cast(\n        case\n            when lower(trim(net_total::varchar)) in ('', 'none', 'null') then null\n            else net_total\n        end as decimal(18, 2)\n    ) as net_total,\n        \n    try_cast(\n        case\n            when lower(trim(total_discount_amount::varchar)) in ('', 'none', 'null') then null\n            else total_discount_amount\n        end as decimal(18, 2)\n    ) as total_discount_amount,\n        \n    try_cast(\n        case\n            when lower(trim(shipping_cost::varchar)) in ('', 'none', 'null') then null\n            else shipping_cost\n        end as decimal(18, 2)\n    ) as shipping_cost,\n        \n    try_cast(\n        case\n            when lower(trim(actual_shipping_cost::varchar)) in ('', 'none', 'null') then null\n            else actual_shipping_cost\n        end as decimal(18, 2)\n    ) as actual_shipping_cost,\n        \n    try_cast(\n        case\n            when lower(trim(payment_processing_fee::varchar)) in ('', 'none', 'null') then null\n            else payment_processing_fee\n        end as decimal(18, 2)\n    ) as payment_processing_fee,\n        \n    try_cast(\n        case\n            when lower(trim(is_expedited::varchar)) in ('', 'none', 'null') then null\n            else trim(is_expedited::varchar)\n        end as boolean\n    ) as is_expedited,\n        \n    try_cast(\n        case\n            when lower(trim(is_reactivated::varchar)) in ('', 'none', 'null') then null\n            else trim(is_reactivated::varchar)\n        end as boolean\n    ) as is_reactivated,\n        \n    case\n        when lower(trim(email)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(email))\n    end as email,\n        \n    case\n        when lower(trim(order_channel)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(order_channel))\n    end as order_channel,\n        \n    case\n        when lower(trim(customer_tier)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(customer_tier))\n    end as customer_tier,\n        \n    case\n        when lower(trim(payment_method)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(payment_method))\n    end as payment_method,\n        \n    case\n        when lower(trim(shipping_speed)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(shipping_speed))\n    end as shipping_speed,\n        \n    case\n        when lower(trim(clv_bucket)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(clv_bucket))\n    end as clv_bucket,\n        \n    case\n        when lower(trim(agent_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(agent_id)\n    end as agent_id,\n        \n    case\n        when lower(trim(shipping_address)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(shipping_address)\n    end as shipping_address,\n        \n    case\n        when lower(trim(billing_address)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(billing_address)\n    end as billing_address,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingest_dt as date) as ingestion_dt,\n        coalesce(\n            cast(\n    try_cast(\n        case\n            when lower(trim(order_date::varchar)) in ('', 'none', 'null') then null\n            else trim(order_date::varchar)\n        end as timestamp\n    ) as date),\n            cast(\n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as date)\n        ) as order_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        \n        true as customer_fk_valid,\n        \n        row_number() over (\n            partition by cleaned.order_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n    \n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (order_id is not null and order_id != '')\n            and \n    (customer_id is not null and customer_id != '')\n            and \n    (order_date is not null)\n            and \n    (gross_total is not null and gross_total >= 0)\n            and \n    (net_total is not null and net_total >= 0)\n            and (total_discount_amount is null or total_discount_amount >= 0)\n            and (net_total <= gross_total or gross_total is null or net_total is null)\n            \n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when not \n    (order_id is not null and order_id != '') then 'missing_order_id' end,\n            case when not \n    (customer_id is not null and customer_id != '') then 'missing_customer_id' end,\n            case when not \n    (order_date is not null) then 'invalid_order_date' end,\n            case when gross_total is null then 'missing_gross_total' end,\n            case when net_total is null then 'missing_net_total' end,\n            case when gross_total < 0 then 'negative_gross_total' end,\n            case when net_total < 0 then 'negative_net_total' end,\n            case when total_discount_amount < 0 then 'negative_discount' end,\n            case when net_total > gross_total and gross_total is not null and net_total is not null\n                 then 'net_exceeds_gross' end,\n            \n            case when row_num > 1 then 'duplicate_order_id' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    order_id,\n    total_items,\n    order_date,\n    customer_id,\n    email,\n    order_channel,\n    is_expedited,\n    customer_tier,\n    gross_total,\n    net_total,\n    total_discount_amount,\n    payment_method,\n    shipping_speed,\n    shipping_cost,\n    agent_id,\n    actual_shipping_cost,\n    payment_processing_fee,\n    shipping_address,\n    billing_address,\n    clv_bucket,\n    is_reactivated,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    order_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    order_id,\n    total_items,\n    order_date,\n    customer_id,\n    email,\n    order_channel,\n    is_expedited,\n    customer_tier,\n    gross_total,\n    net_total,\n    total_discount_amount,\n    payment_method,\n    shipping_speed,\n    shipping_cost,\n    agent_id,\n    actual_shipping_cost,\n    payment_processing_fee,\n    shipping_address,\n    billing_address,\n    clv_bucket,\n    is_reactivated,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    order_dt\nfrom __dbt__cte__int_orders_scored\nwhere is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.094060Z", "completed_at": "2026-01-26T01:20:33.100329Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.101161Z", "completed_at": "2026-01-26T01:20:33.101164Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014135122299194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__order_items", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_order_items_scored as (\n\n\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/order_items/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ndim_orders as (\n    select distinct\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id,\n        cast(\n    try_cast(\n        case\n            when lower(trim(order_date::varchar)) in ('', 'none', 'null') then null\n            else trim(order_date::varchar)\n        end as timestamp\n    ) as date) as order_dt\n    from read_parquet('data/bronze/orders/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end is not null\n),\n\ndim_products as (\n    select distinct\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id\n    from read_parquet('data/silver/dims/product_catalog/**/*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n      and \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) is not null\n),\n\ncleaned as (\n    select\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id,\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id,\n        \n    case\n        when lower(trim(product_name)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(product_name)\n    end as product_name,\n        \n    case\n        when lower(trim(category)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(category))\n    end as category,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    try_cast(\n        case\n            when lower(trim(quantity::varchar)) in ('', 'none', 'null') then null\n            else quantity\n        end as bigint\n    ) as quantity,\n        \n    try_cast(\n        case\n            when lower(trim(unit_price::varchar)) in ('', 'none', 'null') then null\n            else unit_price\n        end as decimal(18, 2)\n    ) as unit_price,\n        \n    try_cast(\n        case\n            when lower(trim(discount_amount::varchar)) in ('', 'none', 'null') then null\n            else discount_amount\n        end as decimal(18, 2)\n    ) as discount_amount,\n        \n    try_cast(\n        case\n            when lower(trim(cost_price::varchar)) in ('', 'none', 'null') then null\n            else cost_price\n        end as decimal(18, 2)\n    ) as cost_price,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingest_dt as date) as ingestion_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        dim_orders.order_id is not null as order_fk_valid,\n        dim_products.product_id is not null as product_fk_valid,\n        coalesce(dim_orders.order_dt, cast(cleaned.ingestion_ts as date)) as order_dt,\n        row_number() over (\n            partition by cleaned.order_id, cleaned.product_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n    left join dim_orders\n        on cleaned.order_id = dim_orders.order_id\n    left join dim_products\n        on cleaned.product_id = dim_products.product_id\n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (order_id is not null and order_id != '')\n            and \n    (product_id is not null and product_id > 0)\n            and \n    (quantity is not null and quantity > 0)\n            and \n    (unit_price is not null and unit_price >= 0)\n            and (discount_amount is null or discount_amount >= 0)\n            and (cost_price is null or cost_price >= 0)\n            and (not False or (order_id is null or order_fk_valid))\n            and (not False or (product_id is null or product_fk_valid))\n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when not \n    (order_id is not null and order_id != '') then 'missing_order_id' end,\n            case when product_id is null or product_id <= 0 then 'invalid_product_id' end,\n            case when quantity is null or quantity <= 0 then 'invalid_quantity' end,\n            case when unit_price is null then 'missing_unit_price' end,\n            case when unit_price < 0 then 'negative_unit_price' end,\n            case when discount_amount < 0 then 'negative_discount' end,\n            case when cost_price < 0 then 'negative_cost_price' end,\n            \n            case when row_num > 1 then 'duplicate_order_product' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    order_id,\n    product_id,\n    product_name,\n    category,\n    quantity,\n    unit_price,\n    discount_amount,\n    cost_price,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    order_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    order_id,\n    product_id,\n    product_name,\n    category,\n    quantity,\n    unit_price,\n    discount_amount,\n    cost_price,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    order_dt\nfrom __dbt__cte__int_order_items_scored\nwhere is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__order_items\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.097201Z", "completed_at": "2026-01-26T01:20:33.100788Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.101664Z", "completed_at": "2026-01-26T01:20:33.101666Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007867813110351562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__order_items_quarantine", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_order_items_scored as (\n\n\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/order_items/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ndim_orders as (\n    select distinct\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id,\n        cast(\n    try_cast(\n        case\n            when lower(trim(order_date::varchar)) in ('', 'none', 'null') then null\n            else trim(order_date::varchar)\n        end as timestamp\n    ) as date) as order_dt\n    from read_parquet('data/bronze/orders/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end is not null\n),\n\ndim_products as (\n    select distinct\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id\n    from read_parquet('data/silver/dims/product_catalog/**/*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n      and \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) is not null\n),\n\ncleaned as (\n    select\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id,\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id,\n        \n    case\n        when lower(trim(product_name)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(product_name)\n    end as product_name,\n        \n    case\n        when lower(trim(category)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(category))\n    end as category,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    try_cast(\n        case\n            when lower(trim(quantity::varchar)) in ('', 'none', 'null') then null\n            else quantity\n        end as bigint\n    ) as quantity,\n        \n    try_cast(\n        case\n            when lower(trim(unit_price::varchar)) in ('', 'none', 'null') then null\n            else unit_price\n        end as decimal(18, 2)\n    ) as unit_price,\n        \n    try_cast(\n        case\n            when lower(trim(discount_amount::varchar)) in ('', 'none', 'null') then null\n            else discount_amount\n        end as decimal(18, 2)\n    ) as discount_amount,\n        \n    try_cast(\n        case\n            when lower(trim(cost_price::varchar)) in ('', 'none', 'null') then null\n            else cost_price\n        end as decimal(18, 2)\n    ) as cost_price,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingest_dt as date) as ingestion_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        dim_orders.order_id is not null as order_fk_valid,\n        dim_products.product_id is not null as product_fk_valid,\n        coalesce(dim_orders.order_dt, cast(cleaned.ingestion_ts as date)) as order_dt,\n        row_number() over (\n            partition by cleaned.order_id, cleaned.product_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n    left join dim_orders\n        on cleaned.order_id = dim_orders.order_id\n    left join dim_products\n        on cleaned.product_id = dim_products.product_id\n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (order_id is not null and order_id != '')\n            and \n    (product_id is not null and product_id > 0)\n            and \n    (quantity is not null and quantity > 0)\n            and \n    (unit_price is not null and unit_price >= 0)\n            and (discount_amount is null or discount_amount >= 0)\n            and (cost_price is null or cost_price >= 0)\n            and (not False or (order_id is null or order_fk_valid))\n            and (not False or (product_id is null or product_fk_valid))\n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when not \n    (order_id is not null and order_id != '') then 'missing_order_id' end,\n            case when product_id is null or product_id <= 0 then 'invalid_product_id' end,\n            case when quantity is null or quantity <= 0 then 'invalid_quantity' end,\n            case when unit_price is null then 'missing_unit_price' end,\n            case when unit_price < 0 then 'negative_unit_price' end,\n            case when discount_amount < 0 then 'negative_discount' end,\n            case when cost_price < 0 then 'negative_cost_price' end,\n            \n            case when row_num > 1 then 'duplicate_order_product' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    order_id,\n    product_id,\n    product_name,\n    category,\n    quantity,\n    unit_price,\n    discount_amount,\n    cost_price,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    order_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    order_id,\n    product_id,\n    product_name,\n    category,\n    quantity,\n    unit_price,\n    discount_amount,\n    cost_price,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    order_dt,\n    invalid_reason,\n    row_num\nfrom __dbt__cte__int_order_items_scored\nwhere not is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__order_items_quarantine\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.105752Z", "completed_at": "2026-01-26T01:20:33.113237Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.113620Z", "completed_at": "2026-01-26T01:20:33.113622Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011270284652709961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__product_catalog_quarantine", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_product_catalog_scored as (\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/product_catalog/category=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ncleaned as (\n    select\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id,\n        \n    case\n        when lower(trim(product_name)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(product_name)\n    end as product_name,\n        \n    case\n        when lower(trim(category)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(category))\n    end as category,\n        \n    try_cast(\n        case\n            when lower(trim(unit_price::varchar)) in ('', 'none', 'null') then null\n            else unit_price\n        end as decimal(18, 2)\n    ) as unit_price,\n        \n    try_cast(\n        case\n            when lower(trim(cost_price::varchar)) in ('', 'none', 'null') then null\n            else cost_price\n        end as decimal(18, 2)\n    ) as cost_price,\n        \n    try_cast(\n        case\n            when lower(trim(inventory_quantity::varchar)) in ('', 'none', 'null') then null\n            else inventory_quantity\n        end as bigint\n    ) as inventory_quantity,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingestion_ts as date) as ingestion_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        row_number() over (\n            partition by cleaned.product_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (product_id is not null and product_id > 0)\n            and \n    (product_name is not null and product_name != '')\n            and \n    (unit_price is not null and unit_price >= 0)\n            and (cost_price is null or cost_price >= 0)\n            and (inventory_quantity is null or inventory_quantity >= 0)\n            and (unit_price is null or cost_price is null or unit_price >= cost_price)\n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when product_id is null or product_id <= 0 then 'invalid_product_id' end,\n            case when not \n    (product_name is not null and product_name != '') then 'missing_product_name' end,\n            case when unit_price is null then 'missing_unit_price' end,\n            case when unit_price < 0 then 'negative_unit_price' end,\n            case when cost_price < 0 then 'negative_cost_price' end,\n            case when inventory_quantity < 0 then 'negative_inventory' end,\n            case when unit_price < cost_price and unit_price is not null and cost_price is not null\n                 then 'unit_price_below_cost' end,\n            case when row_num > 1 then 'duplicate_product_id' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    product_id,\n    product_name,\n    category,\n    unit_price,\n    cost_price,\n    inventory_quantity,\n    batch_id,\n    ingestion_ts,\n    event_id,\n    source_file,\n    ingestion_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    product_id,\n    product_name,\n    category,\n    unit_price,\n    cost_price,\n    inventory_quantity,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    invalid_reason,\n    row_num\nfrom __dbt__cte__int_product_catalog_scored\nwhere not is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__product_catalog_quarantine\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.103446Z", "completed_at": "2026-01-26T01:20:33.113436Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.114063Z", "completed_at": "2026-01-26T01:20:33.114066Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012118816375732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__product_catalog", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_product_catalog_scored as (\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/product_catalog/category=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ncleaned as (\n    select\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id,\n        \n    case\n        when lower(trim(product_name)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(product_name)\n    end as product_name,\n        \n    case\n        when lower(trim(category)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(category))\n    end as category,\n        \n    try_cast(\n        case\n            when lower(trim(unit_price::varchar)) in ('', 'none', 'null') then null\n            else unit_price\n        end as decimal(18, 2)\n    ) as unit_price,\n        \n    try_cast(\n        case\n            when lower(trim(cost_price::varchar)) in ('', 'none', 'null') then null\n            else cost_price\n        end as decimal(18, 2)\n    ) as cost_price,\n        \n    try_cast(\n        case\n            when lower(trim(inventory_quantity::varchar)) in ('', 'none', 'null') then null\n            else inventory_quantity\n        end as bigint\n    ) as inventory_quantity,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingestion_ts as date) as ingestion_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        row_number() over (\n            partition by cleaned.product_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (product_id is not null and product_id > 0)\n            and \n    (product_name is not null and product_name != '')\n            and \n    (unit_price is not null and unit_price >= 0)\n            and (cost_price is null or cost_price >= 0)\n            and (inventory_quantity is null or inventory_quantity >= 0)\n            and (unit_price is null or cost_price is null or unit_price >= cost_price)\n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when product_id is null or product_id <= 0 then 'invalid_product_id' end,\n            case when not \n    (product_name is not null and product_name != '') then 'missing_product_name' end,\n            case when unit_price is null then 'missing_unit_price' end,\n            case when unit_price < 0 then 'negative_unit_price' end,\n            case when cost_price < 0 then 'negative_cost_price' end,\n            case when inventory_quantity < 0 then 'negative_inventory' end,\n            case when unit_price < cost_price and unit_price is not null and cost_price is not null\n                 then 'unit_price_below_cost' end,\n            case when row_num > 1 then 'duplicate_product_id' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    product_id,\n    product_name,\n    category,\n    unit_price,\n    cost_price,\n    inventory_quantity,\n    batch_id,\n    ingestion_ts,\n    event_id,\n    source_file,\n    ingestion_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    product_id,\n    product_name,\n    category,\n    unit_price,\n    cost_price,\n    inventory_quantity,\n    batch_id,\n    ingestion_ts,\n    event_id,\n    source_file,\n    ingestion_dt\nfrom __dbt__cte__int_product_catalog_scored\nwhere is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__product_catalog\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.108240Z", "completed_at": "2026-01-26T01:20:33.113899Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.114707Z", "completed_at": "2026-01-26T01:20:33.114709Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011758804321289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__return_items", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_return_items_scored as (\n\n\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/return_items/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ndim_returns as (\n    select distinct\n        \n    case\n        when lower(trim(return_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(return_id)\n    end as return_id,\n        cast(\n    try_cast(\n        case\n            when lower(trim(return_date::varchar)) in ('', 'none', 'null') then null\n            else trim(return_date::varchar)\n        end as timestamp\n    ) as date) as return_dt\n    from read_parquet('data/bronze/returns/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where \n    case\n        when lower(trim(return_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(return_id)\n    end is not null\n),\n\ndim_orders as (\n    select distinct\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id\n    from read_parquet('data/bronze/orders/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end is not null\n),\n\ndim_products as (\n    select distinct\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id\n    from read_parquet('data/silver/dims/product_catalog/**/*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n      and \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) is not null\n),\n\ncleaned as (\n    select\n        \n    try_cast(\n        case\n            when lower(trim(return_item_id::varchar)) in ('', 'none', 'null') then null\n            else return_item_id\n        end as bigint\n    ) as return_item_id,\n        \n    case\n        when lower(trim(return_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(return_id)\n    end as return_id,\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id,\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id,\n        \n    case\n        when lower(trim(product_name)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(product_name)\n    end as product_name,\n        \n    case\n        when lower(trim(category)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(category))\n    end as category,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    try_cast(\n        case\n            when lower(trim(quantity_returned::varchar)) in ('', 'none', 'null') then null\n            else quantity_returned\n        end as bigint\n    ) as quantity_returned,\n        \n    try_cast(\n        case\n            when lower(trim(unit_price::varchar)) in ('', 'none', 'null') then null\n            else unit_price\n        end as decimal(18, 2)\n    ) as unit_price,\n        \n    try_cast(\n        case\n            when lower(trim(cost_price::varchar)) in ('', 'none', 'null') then null\n            else cost_price\n        end as decimal(18, 2)\n    ) as cost_price,\n        \n    try_cast(\n        case\n            when lower(trim(refunded_amount::varchar)) in ('', 'none', 'null') then null\n            else refunded_amount\n        end as decimal(18, 2)\n    ) as refunded_amount,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingest_dt as date) as ingestion_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        dim_returns.return_id is not null as return_fk_valid,\n        dim_orders.order_id is not null as order_fk_valid,\n        dim_products.product_id is not null as product_fk_valid,\n        coalesce(dim_returns.return_dt, cast(cleaned.ingestion_ts as date)) as return_dt,\n        row_number() over (\n            partition by cleaned.return_id, cleaned.product_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n    left join dim_returns\n        on cleaned.return_id = dim_returns.return_id\n    left join dim_orders\n        on cleaned.order_id = dim_orders.order_id\n    left join dim_products\n        on cleaned.product_id = dim_products.product_id\n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (return_item_id is not null and return_item_id > 0)\n            and \n    (return_id is not null and return_id != '')\n            and \n    (order_id is not null and order_id != '')\n            and \n    (product_id is not null and product_id > 0)\n            and \n    (quantity_returned is not null and quantity_returned > 0)\n            and (unit_price is null or unit_price >= 0)\n            and (cost_price is null or cost_price >= 0)\n            and (refunded_amount is null or refunded_amount >= 0)\n            and (not False or (return_id is null or return_fk_valid))\n            and (not False or (order_id is null or order_fk_valid))\n            and (not False or (product_id is null or product_fk_valid))\n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when return_item_id is null or return_item_id <= 0 then 'invalid_return_item_id' end,\n            case when not \n    (return_id is not null and return_id != '') then 'missing_return_id' end,\n            case when not \n    (order_id is not null and order_id != '') then 'missing_order_id' end,\n            case when product_id is null or product_id <= 0 then 'invalid_product_id' end,\n            case when quantity_returned is null or quantity_returned <= 0 then 'invalid_quantity_returned' end,\n            case when unit_price < 0 then 'negative_unit_price' end,\n            case when cost_price < 0 then 'negative_cost_price' end,\n            case when refunded_amount < 0 then 'negative_refunded_amount' end,\n            \n            case when row_num > 1 then 'duplicate_return_item_line' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    return_item_id,\n    return_id,\n    order_id,\n    product_id,\n    product_name,\n    category,\n    quantity_returned,\n    unit_price,\n    cost_price,\n    refunded_amount,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    return_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    return_item_id,\n    return_id,\n    order_id,\n    product_id,\n    product_name,\n    category,\n    quantity_returned,\n    unit_price,\n    cost_price,\n    refunded_amount,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    return_dt\nfrom __dbt__cte__int_return_items_scored\nwhere is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__return_items\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.110618Z", "completed_at": "2026-01-26T01:20:33.114353Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.115251Z", "completed_at": "2026-01-26T01:20:33.115254Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012003183364868164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__return_items_quarantine", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_return_items_scored as (\n\n\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/return_items/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ndim_returns as (\n    select distinct\n        \n    case\n        when lower(trim(return_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(return_id)\n    end as return_id,\n        cast(\n    try_cast(\n        case\n            when lower(trim(return_date::varchar)) in ('', 'none', 'null') then null\n            else trim(return_date::varchar)\n        end as timestamp\n    ) as date) as return_dt\n    from read_parquet('data/bronze/returns/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where \n    case\n        when lower(trim(return_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(return_id)\n    end is not null\n),\n\ndim_orders as (\n    select distinct\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id\n    from read_parquet('data/bronze/orders/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end is not null\n),\n\ndim_products as (\n    select distinct\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id\n    from read_parquet('data/silver/dims/product_catalog/**/*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n      and \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) is not null\n),\n\ncleaned as (\n    select\n        \n    try_cast(\n        case\n            when lower(trim(return_item_id::varchar)) in ('', 'none', 'null') then null\n            else return_item_id\n        end as bigint\n    ) as return_item_id,\n        \n    case\n        when lower(trim(return_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(return_id)\n    end as return_id,\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id,\n        \n    try_cast(\n        case\n            when lower(trim(product_id::varchar)) in ('', 'none', 'null') then null\n            else product_id\n        end as bigint\n    ) as product_id,\n        \n    case\n        when lower(trim(product_name)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(product_name)\n    end as product_name,\n        \n    case\n        when lower(trim(category)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(category))\n    end as category,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    try_cast(\n        case\n            when lower(trim(quantity_returned::varchar)) in ('', 'none', 'null') then null\n            else quantity_returned\n        end as bigint\n    ) as quantity_returned,\n        \n    try_cast(\n        case\n            when lower(trim(unit_price::varchar)) in ('', 'none', 'null') then null\n            else unit_price\n        end as decimal(18, 2)\n    ) as unit_price,\n        \n    try_cast(\n        case\n            when lower(trim(cost_price::varchar)) in ('', 'none', 'null') then null\n            else cost_price\n        end as decimal(18, 2)\n    ) as cost_price,\n        \n    try_cast(\n        case\n            when lower(trim(refunded_amount::varchar)) in ('', 'none', 'null') then null\n            else refunded_amount\n        end as decimal(18, 2)\n    ) as refunded_amount,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingest_dt as date) as ingestion_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        dim_returns.return_id is not null as return_fk_valid,\n        dim_orders.order_id is not null as order_fk_valid,\n        dim_products.product_id is not null as product_fk_valid,\n        coalesce(dim_returns.return_dt, cast(cleaned.ingestion_ts as date)) as return_dt,\n        row_number() over (\n            partition by cleaned.return_id, cleaned.product_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n    left join dim_returns\n        on cleaned.return_id = dim_returns.return_id\n    left join dim_orders\n        on cleaned.order_id = dim_orders.order_id\n    left join dim_products\n        on cleaned.product_id = dim_products.product_id\n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (return_item_id is not null and return_item_id > 0)\n            and \n    (return_id is not null and return_id != '')\n            and \n    (order_id is not null and order_id != '')\n            and \n    (product_id is not null and product_id > 0)\n            and \n    (quantity_returned is not null and quantity_returned > 0)\n            and (unit_price is null or unit_price >= 0)\n            and (cost_price is null or cost_price >= 0)\n            and (refunded_amount is null or refunded_amount >= 0)\n            and (not False or (return_id is null or return_fk_valid))\n            and (not False or (order_id is null or order_fk_valid))\n            and (not False or (product_id is null or product_fk_valid))\n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when return_item_id is null or return_item_id <= 0 then 'invalid_return_item_id' end,\n            case when not \n    (return_id is not null and return_id != '') then 'missing_return_id' end,\n            case when not \n    (order_id is not null and order_id != '') then 'missing_order_id' end,\n            case when product_id is null or product_id <= 0 then 'invalid_product_id' end,\n            case when quantity_returned is null or quantity_returned <= 0 then 'invalid_quantity_returned' end,\n            case when unit_price < 0 then 'negative_unit_price' end,\n            case when cost_price < 0 then 'negative_cost_price' end,\n            case when refunded_amount < 0 then 'negative_refunded_amount' end,\n            \n            case when row_num > 1 then 'duplicate_return_item_line' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    return_item_id,\n    return_id,\n    order_id,\n    product_id,\n    product_name,\n    category,\n    quantity_returned,\n    unit_price,\n    cost_price,\n    refunded_amount,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    return_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    return_item_id,\n    return_id,\n    order_id,\n    product_id,\n    product_name,\n    category,\n    quantity_returned,\n    unit_price,\n    cost_price,\n    refunded_amount,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    return_dt,\n    invalid_reason,\n    row_num\nfrom __dbt__cte__int_return_items_scored\nwhere not is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__return_items_quarantine\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.117079Z", "completed_at": "2026-01-26T01:20:33.127441Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.127673Z", "completed_at": "2026-01-26T01:20:33.127676Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01213693618774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__returns", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_returns_scored as (\n\n\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/returns/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ndim_orders as (\n    select distinct\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id\n    from read_parquet('data/bronze/orders/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end is not null\n),\n\ndim_customers as (\n    select distinct\n        customer_id\n    from read_parquet('data/silver/dims/customers/**/*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ncleaned as (\n    select\n        \n    case\n        when lower(trim(return_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(return_id)\n    end as return_id,\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id,\n        \n    case\n        when lower(trim(customer_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(customer_id)\n    end as customer_id,\n        \n    try_cast(\n        case\n            when lower(trim(return_date::varchar)) in ('', 'none', 'null') then null\n            else trim(return_date::varchar)\n        end as timestamp\n    ) as return_date,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    try_cast(\n        case\n            when lower(trim(refunded_amount::varchar)) in ('', 'none', 'null') then null\n            else refunded_amount\n        end as decimal(18, 2)\n    ) as refunded_amount,\n        \n    case\n        when lower(trim(email)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(email))\n    end as email,\n        \n    case\n        when lower(trim(return_channel)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(return_channel))\n    end as return_channel,\n        \n    case\n        when lower(trim(refund_method)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(refund_method))\n    end as refund_method,\n        \n    case\n        when lower(trim(return_type)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(return_type))\n    end as return_type,\n        \n    case\n        when lower(trim(reason)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(reason)\n    end as reason,\n        \n    case\n        when lower(trim(agent_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(agent_id)\n    end as agent_id,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingest_dt as date) as ingestion_dt,\n        coalesce(\n            cast(\n    try_cast(\n        case\n            when lower(trim(return_date::varchar)) in ('', 'none', 'null') then null\n            else trim(return_date::varchar)\n        end as timestamp\n    ) as date),\n            cast(\n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as date)\n        ) as return_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        dim_orders.order_id is not null as order_fk_valid,\n        dim_customers.customer_id is not null as customer_fk_valid,\n        row_number() over (\n            partition by cleaned.return_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n    left join dim_orders\n        on cleaned.order_id = dim_orders.order_id\n    left join dim_customers\n        on cleaned.customer_id = dim_customers.customer_id\n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (return_id is not null and return_id != '')\n            and \n    (order_id is not null and order_id != '')\n            and \n    (customer_id is not null and customer_id != '')\n            and \n    (return_date is not null)\n            and (refunded_amount is null or refunded_amount >= 0)\n            and (not False or (order_id is null or order_fk_valid))\n            and (\n                not False\n                or customer_id is null\n                or \n    (customer_id is not null and customer_id like 'GUEST-%')\n                or customer_fk_valid\n            )\n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when not \n    (return_id is not null and return_id != '') then 'missing_return_id' end,\n            case when not \n    (order_id is not null and order_id != '') then 'missing_order_id' end,\n            case when not \n    (customer_id is not null and customer_id != '') then 'missing_customer_id' end,\n            case when not \n    (return_date is not null) then 'invalid_return_date' end,\n            case when refunded_amount < 0 then 'negative_refunded_amount' end,\n            \n            case when row_num > 1 then 'duplicate_return_id' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    return_id,\n    order_id,\n    customer_id,\n    email,\n    return_date,\n    reason,\n    return_type,\n    refunded_amount,\n    return_channel,\n    agent_id,\n    refund_method,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    return_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    return_id,\n    order_id,\n    customer_id,\n    email,\n    return_date,\n    reason,\n    return_type,\n    refunded_amount,\n    return_channel,\n    agent_id,\n    refund_method,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    return_dt\nfrom __dbt__cte__int_returns_scored\nwhere is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__returns\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.119631Z", "completed_at": "2026-01-26T01:20:33.128198Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.128664Z", "completed_at": "2026-01-26T01:20:33.128667Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012748003005981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__returns_quarantine", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_returns_scored as (\n\n\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/returns/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ndim_orders as (\n    select distinct\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id\n    from read_parquet('data/bronze/orders/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end is not null\n),\n\ndim_customers as (\n    select distinct\n        customer_id\n    from read_parquet('data/silver/dims/customers/**/*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\ncleaned as (\n    select\n        \n    case\n        when lower(trim(return_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(return_id)\n    end as return_id,\n        \n    case\n        when lower(trim(order_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(order_id)\n    end as order_id,\n        \n    case\n        when lower(trim(customer_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(customer_id)\n    end as customer_id,\n        \n    try_cast(\n        case\n            when lower(trim(return_date::varchar)) in ('', 'none', 'null') then null\n            else trim(return_date::varchar)\n        end as timestamp\n    ) as return_date,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    try_cast(\n        case\n            when lower(trim(refunded_amount::varchar)) in ('', 'none', 'null') then null\n            else refunded_amount\n        end as decimal(18, 2)\n    ) as refunded_amount,\n        \n    case\n        when lower(trim(email)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(email))\n    end as email,\n        \n    case\n        when lower(trim(return_channel)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(return_channel))\n    end as return_channel,\n        \n    case\n        when lower(trim(refund_method)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(refund_method))\n    end as refund_method,\n        \n    case\n        when lower(trim(return_type)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(return_type))\n    end as return_type,\n        \n    case\n        when lower(trim(reason)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(reason)\n    end as reason,\n        \n    case\n        when lower(trim(agent_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(agent_id)\n    end as agent_id,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingest_dt as date) as ingestion_dt,\n        coalesce(\n            cast(\n    try_cast(\n        case\n            when lower(trim(return_date::varchar)) in ('', 'none', 'null') then null\n            else trim(return_date::varchar)\n        end as timestamp\n    ) as date),\n            cast(\n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as date)\n        ) as return_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        dim_orders.order_id is not null as order_fk_valid,\n        dim_customers.customer_id is not null as customer_fk_valid,\n        row_number() over (\n            partition by cleaned.return_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n    left join dim_orders\n        on cleaned.order_id = dim_orders.order_id\n    left join dim_customers\n        on cleaned.customer_id = dim_customers.customer_id\n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (return_id is not null and return_id != '')\n            and \n    (order_id is not null and order_id != '')\n            and \n    (customer_id is not null and customer_id != '')\n            and \n    (return_date is not null)\n            and (refunded_amount is null or refunded_amount >= 0)\n            and (not False or (order_id is null or order_fk_valid))\n            and (\n                not False\n                or customer_id is null\n                or \n    (customer_id is not null and customer_id like 'GUEST-%')\n                or customer_fk_valid\n            )\n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when not \n    (return_id is not null and return_id != '') then 'missing_return_id' end,\n            case when not \n    (order_id is not null and order_id != '') then 'missing_order_id' end,\n            case when not \n    (customer_id is not null and customer_id != '') then 'missing_customer_id' end,\n            case when not \n    (return_date is not null) then 'invalid_return_date' end,\n            case when refunded_amount < 0 then 'negative_refunded_amount' end,\n            \n            case when row_num > 1 then 'duplicate_return_id' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    return_id,\n    order_id,\n    customer_id,\n    email,\n    return_date,\n    reason,\n    return_type,\n    refunded_amount,\n    return_channel,\n    agent_id,\n    refund_method,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    return_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    return_id,\n    order_id,\n    customer_id,\n    email,\n    return_date,\n    reason,\n    return_type,\n    refunded_amount,\n    return_channel,\n    agent_id,\n    refund_method,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    return_dt,\n    invalid_reason,\n    row_num\nfrom __dbt__cte__int_returns_scored\nwhere not is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__returns_quarantine\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.125231Z", "completed_at": "2026-01-26T01:20:33.128924Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.129616Z", "completed_at": "2026-01-26T01:20:33.129619Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012764215469360352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__shopping_carts_quarantine", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_shopping_carts_scored as (\n\n\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/shopping_carts/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\n\n\ncleaned as (\n    select\n        \n    case\n        when lower(trim(cart_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(cart_id)\n    end as cart_id,\n        \n    case\n        when lower(trim(customer_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(customer_id)\n    end as customer_id,\n        \n    try_cast(\n        case\n            when lower(trim(created_at::varchar)) in ('', 'none', 'null') then null\n            else trim(created_at::varchar)\n        end as timestamp\n    ) as created_at,\n        \n    try_cast(\n        case\n            when lower(trim(updated_at::varchar)) in ('', 'none', 'null') then null\n            else trim(updated_at::varchar)\n        end as timestamp\n    ) as updated_at,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    try_cast(\n        case\n            when lower(trim(cart_total::varchar)) in ('', 'none', 'null') then null\n            else cart_total\n        end as decimal(18, 2)\n    ) as cart_total,\n        \n    case\n        when lower(trim(status)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(status))\n    end as status,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingest_dt as date) as ingestion_dt,\n        cast(\n    try_cast(\n        case\n            when lower(trim(created_at::varchar)) in ('', 'none', 'null') then null\n            else trim(created_at::varchar)\n        end as timestamp\n    ) as date) as created_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        \n        true as customer_fk_valid,\n        \n        row_number() over (\n            partition by cleaned.cart_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n    \n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (cart_id is not null and cart_id != '')\n            and \n    (customer_id is not null and customer_id != '')\n            and \n    (created_at is not null)\n            and (cart_total is null or cart_total >= 0)\n            and (updated_at is null or created_at is null or updated_at >= created_at)\n            \n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when not \n    (cart_id is not null and cart_id != '') then 'missing_cart_id' end,\n            case when not \n    (customer_id is not null and customer_id != '') then 'missing_customer_id' end,\n            case when not \n    (created_at is not null) then 'invalid_created_at' end,\n            case when cart_total < 0 then 'negative_cart_total' end,\n            case when updated_at < created_at and updated_at is not null and created_at is not null\n                 then 'updated_before_created' end,\n            \n            case when row_num > 1 then 'duplicate_cart_id' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    cart_id,\n    customer_id,\n    created_at,\n    updated_at,\n    cart_total,\n    status,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    created_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    cart_id,\n    customer_id,\n    created_at,\n    updated_at,\n    cart_total,\n    status,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    created_dt,\n    invalid_reason,\n    row_num\nfrom __dbt__cte__int_shopping_carts_scored\nwhere not is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__shopping_carts_quarantine\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.122846Z", "completed_at": "2026-01-26T01:20:33.129089Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.129913Z", "completed_at": "2026-01-26T01:20:33.129915Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.013406991958618164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecom_dbt_duckdb.stg_ecommerce__shopping_carts", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_shopping_carts_scored as (\n\n\n\n\n\n\nwith raw as (\n    select *\n    from read_parquet('data/bronze/shopping_carts/ingest_dt=*/part-*.parquet', union_by_name=true, hive_partitioning=true)\n    where true\n),\n\n\n\ncleaned as (\n    select\n        \n    case\n        when lower(trim(cart_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(cart_id)\n    end as cart_id,\n        \n    case\n        when lower(trim(customer_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(customer_id)\n    end as customer_id,\n        \n    try_cast(\n        case\n            when lower(trim(created_at::varchar)) in ('', 'none', 'null') then null\n            else trim(created_at::varchar)\n        end as timestamp\n    ) as created_at,\n        \n    try_cast(\n        case\n            when lower(trim(updated_at::varchar)) in ('', 'none', 'null') then null\n            else trim(updated_at::varchar)\n        end as timestamp\n    ) as updated_at,\n        \n    try_cast(\n        case\n            when lower(trim(ingestion_ts::varchar)) in ('', 'none', 'null') then null\n            else trim(ingestion_ts::varchar)\n        end as timestamp\n    ) as ingestion_ts,\n        \n    try_cast(\n        case\n            when lower(trim(cart_total::varchar)) in ('', 'none', 'null') then null\n            else cart_total\n        end as decimal(18, 2)\n    ) as cart_total,\n        \n    case\n        when lower(trim(status)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else lower(trim(status))\n    end as status,\n        \n    case\n        when lower(trim(batch_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(batch_id)\n    end as batch_id,\n        \n    case\n        when lower(trim(event_id)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(event_id)\n    end as event_id,\n        \n    case\n        when lower(trim(source_file)) in ('', 'none', 'null', 'n/a', 'nan') then null\n        else trim(source_file)\n    end as source_file,\n        \n    cast(ingest_dt as date) as ingestion_dt,\n        cast(\n    try_cast(\n        case\n            when lower(trim(created_at::varchar)) in ('', 'none', 'null') then null\n            else trim(created_at::varchar)\n        end as timestamp\n    ) as date) as created_dt\n    from raw\n),\n\nvalidated as (\n    select\n        cleaned.*,\n        \n        true as customer_fk_valid,\n        \n        row_number() over (\n            partition by cleaned.cart_id\n            order by cleaned.ingestion_ts desc nulls last, cleaned.event_id desc\n        ) as row_num\n    from cleaned\n    \n),\n\nscored as (\n    select\n        *,\n        (\n            \n    (cart_id is not null and cart_id != '')\n            and \n    (customer_id is not null and customer_id != '')\n            and \n    (created_at is not null)\n            and (cart_total is null or cart_total >= 0)\n            and (updated_at is null or created_at is null or updated_at >= created_at)\n            \n            and row_num = 1\n        ) as is_valid,\n        coalesce(nullif(trim(concat_ws(' | ',\n            case when not \n    (cart_id is not null and cart_id != '') then 'missing_cart_id' end,\n            case when not \n    (customer_id is not null and customer_id != '') then 'missing_customer_id' end,\n            case when not \n    (created_at is not null) then 'invalid_created_at' end,\n            case when cart_total < 0 then 'negative_cart_total' end,\n            case when updated_at < created_at and updated_at is not null and created_at is not null\n                 then 'updated_before_created' end,\n            \n            case when row_num > 1 then 'duplicate_cart_id' end\n        )), ''), 'all_fields_null') as invalid_reason\n    from validated\n)\n\nselect\n    cart_id,\n    customer_id,\n    created_at,\n    updated_at,\n    cart_total,\n    status,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    created_dt,\n    is_valid,\n    invalid_reason,\n    row_num\nfrom scored\n) select\n    cart_id,\n    customer_id,\n    created_at,\n    updated_at,\n    cart_total,\n    status,\n    batch_id,\n    ingestion_ts,\n    ingestion_dt,\n    event_id,\n    source_file,\n    created_dt\nfrom __dbt__cte__int_shopping_carts_scored\nwhere is_valid", "relation_name": "\"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.130173Z", "completed_at": "2026-01-26T01:20:33.132939Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.134898Z", "completed_at": "2026-01-26T01:20:33.134900Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006470918655395508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__cart_items_cart_id__like_CART_.e98701f3ad", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\n\nwhere not(cart_id like 'CART-%')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.133097Z", "completed_at": "2026-01-26T01:20:33.138389Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.138785Z", "completed_at": "2026-01-26T01:20:33.138788Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0071048736572265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__cart_items_quantity_0.225c4996f1", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\n\nwhere not(quantity > 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.136711Z", "completed_at": "2026-01-26T01:20:33.141079Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.141627Z", "completed_at": "2026-01-26T01:20:33.141629Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008961915969848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__cart_items_unit_price_0.f1842bb862", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\n\nwhere not(unit_price >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.135190Z", "completed_at": "2026-01-26T01:20:33.141262Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.141947Z", "completed_at": "2026-01-26T01:20:33.141949Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009428024291992188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__cart_items_quarantine_invalid_reason_.5bd16b4389", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items_quarantine\"\n\nwhere not(invalid_reason <> '')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.139411Z", "completed_at": "2026-01-26T01:20:33.142206Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.145770Z", "completed_at": "2026-01-26T01:20:33.145772Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0072100162506103516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_unique_combination_of_columns_stg_ecommerce__cart_items_cart_id__product_id__added_at.9cd06d0834", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        cart_id, product_id, added_at\n    from \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\n    group by cart_id, product_id, added_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.142354Z", "completed_at": "2026-01-26T01:20:33.146648Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.147348Z", "completed_at": "2026-01-26T01:20:33.147350Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006491184234619141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__cart_items_added_at.d167b74732", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect added_at\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\nwhere added_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.147614Z", "completed_at": "2026-01-26T01:20:33.152509Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.153025Z", "completed_at": "2026-01-26T01:20:33.153028Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006988048553466797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__cart_items_added_dt.fd080f0760", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect added_dt\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\nwhere added_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.149040Z", "completed_at": "2026-01-26T01:20:33.152682Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.153295Z", "completed_at": "2026-01-26T01:20:33.153298Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007074832916259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__cart_items_batch_id.888c7fcd1e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect batch_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\nwhere batch_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.150923Z", "completed_at": "2026-01-26T01:20:33.154984Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.155562Z", "completed_at": "2026-01-26T01:20:33.155565Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008437156677246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__cart_items_cart_id.033940b26b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cart_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\nwhere cart_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.153569Z", "completed_at": "2026-01-26T01:20:33.156199Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.156862Z", "completed_at": "2026-01-26T01:20:33.156865Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004625082015991211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__cart_items_cart_item_id.72ccab79a5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cart_item_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\nwhere cart_item_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.157390Z", "completed_at": "2026-01-26T01:20:33.162094Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.162601Z", "completed_at": "2026-01-26T01:20:33.162604Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006808757781982422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__cart_items_event_id.a7c5785750", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.158716Z", "completed_at": "2026-01-26T01:20:33.162434Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.164321Z", "completed_at": "2026-01-26T01:20:33.164324Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008334159851074219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__cart_items_ingestion_ts.264682b6f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingestion_ts\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\nwhere ingestion_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.160656Z", "completed_at": "2026-01-26T01:20:33.164795Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.165370Z", "completed_at": "2026-01-26T01:20:33.165373Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00826716423034668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__cart_items_product_id.df1cbd653d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.162862Z", "completed_at": "2026-01-26T01:20:33.165827Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.166536Z", "completed_at": "2026-01-26T01:20:33.166538Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0061299800872802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__cart_items_quantity.87da55ca99", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.166791Z", "completed_at": "2026-01-26T01:20:33.172367Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.172912Z", "completed_at": "2026-01-26T01:20:33.172914Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007767677307128906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__cart_items_quarantine_invalid_reason.bbc781b783", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invalid_reason\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items_quarantine\"\nwhere invalid_reason is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.169029Z", "completed_at": "2026-01-26T01:20:33.172712Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.174655Z", "completed_at": "2026-01-26T01:20:33.174659Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009052276611328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__cart_items_source_file.bf2f4e0863", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_file\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\nwhere source_file is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.171031Z", "completed_at": "2026-01-26T01:20:33.174929Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.175505Z", "completed_at": "2026-01-26T01:20:33.175507Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006696939468383789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__cart_items_unit_price.6fa526df0a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unit_price\nfrom \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\nwhere unit_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.173192Z", "completed_at": "2026-01-26T01:20:33.176205Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.176870Z", "completed_at": "2026-01-26T01:20:33.176872Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0060732364654541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__customers_customer_id__like_CUST_.e3d30853e8", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__customers\"\n\nwhere not(customer_id like 'CUST-%')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.178660Z", "completed_at": "2026-01-26T01:20:33.182210Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.183930Z", "completed_at": "2026-01-26T01:20:33.183934Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007999897003173828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__customers_batch_id.a47ea04f14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect batch_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__customers\"\nwhere batch_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.177273Z", "completed_at": "2026-01-26T01:20:33.183761Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.184234Z", "completed_at": "2026-01-26T01:20:33.184236Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008496999740600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__customers_email__like_.501ffb73aa", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__customers\"\n\nwhere not(email like '%@%.%')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.180568Z", "completed_at": "2026-01-26T01:20:33.184494Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.185055Z", "completed_at": "2026-01-26T01:20:33.185057Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007977962493896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__customers_customer_id.8075de9339", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__customers\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.182394Z", "completed_at": "2026-01-26T01:20:33.185314Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.186015Z", "completed_at": "2026-01-26T01:20:33.186017Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005673885345458984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__customers_email.3baaab6787", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email\nfrom \"ecom\".\"main\".\"stg_ecommerce__customers\"\nwhere email is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.186991Z", "completed_at": "2026-01-26T01:20:33.193741Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.193956Z", "completed_at": "2026-01-26T01:20:33.193959Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008505821228027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__customers_event_id.310669e91d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__customers\"\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.188354Z", "completed_at": "2026-01-26T01:20:33.194779Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.196609Z", "completed_at": "2026-01-26T01:20:33.196611Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010990142822265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__customers_ingestion_ts.b079e7a3e7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingestion_ts\nfrom \"ecom\".\"main\".\"stg_ecommerce__customers\"\nwhere ingestion_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.190721Z", "completed_at": "2026-01-26T01:20:33.194931Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.196883Z", "completed_at": "2026-01-26T01:20:33.196885Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010294914245605469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__customers_signup_date.c58de89516", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect signup_date\nfrom \"ecom\".\"main\".\"stg_ecommerce__customers\"\nwhere signup_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.192293Z", "completed_at": "2026-01-26T01:20:33.196434Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.197180Z", "completed_at": "2026-01-26T01:20:33.197182Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006745100021362305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__customers_signup_dt.917d92b8b4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect signup_dt\nfrom \"ecom\".\"main\".\"stg_ecommerce__customers\"\nwhere signup_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.195071Z", "completed_at": "2026-01-26T01:20:33.197817Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.198549Z", "completed_at": "2026-01-26T01:20:33.198552Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004161834716796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__customers_source_file.570c44dd4e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_file\nfrom \"ecom\".\"main\".\"stg_ecommerce__customers\"\nwhere source_file is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.199634Z", "completed_at": "2026-01-26T01:20:33.206444Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.206972Z", "completed_at": "2026-01-26T01:20:33.206974Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008825063705444336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.unique_stg_ecommerce__customers_customer_id.30a7101ea9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecom\".\"main\".\"stg_ecommerce__customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.203373Z", "completed_at": "2026-01-26T01:20:33.206624Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.207250Z", "completed_at": "2026-01-26T01:20:33.207253Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008501052856445312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__customers_quarantine_invalid_reason.401cea5e34", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invalid_reason\nfrom \"ecom\".\"main\".\"stg_ecommerce__customers_quarantine\"\nwhere invalid_reason is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.201769Z", "completed_at": "2026-01-26T01:20:33.206794Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.207667Z", "completed_at": "2026-01-26T01:20:33.207669Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009330987930297852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__customers_quarantine_invalid_reason_.6e5227d7f0", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__customers_quarantine\"\n\nwhere not(invalid_reason <> '')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.204988Z", "completed_at": "2026-01-26T01:20:33.207519Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.208299Z", "completed_at": "2026-01-26T01:20:33.208301Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005125284194946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__orders_quarantine_invalid_reason_.c9fe99cb7c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders_quarantine\"\n\nwhere not(invalid_reason <> '')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.212043Z", "completed_at": "2026-01-26T01:20:33.216354Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.216705Z", "completed_at": "2026-01-26T01:20:33.216707Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007846355438232422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.accepted_values_stg_ecommerce__orders_customer_tier__bronze__silver__gold__platinum.5eb3531732", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_tier as value_field,\n        count(*) as n_records\n\n    from \"ecom\".\"main\".\"stg_ecommerce__orders\"\n    group by customer_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'bronze','silver','gold','platinum'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.210101Z", "completed_at": "2026-01-26T01:20:33.216529Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.217014Z", "completed_at": "2026-01-26T01:20:33.217016Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008315086364746094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__orders_quarantine_invalid_reason.6f685fa8d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invalid_reason\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders_quarantine\"\nwhere invalid_reason is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.213555Z", "completed_at": "2026-01-26T01:20:33.217321Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.218042Z", "completed_at": "2026-01-26T01:20:33.218045Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008848905563354492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.accepted_values_stg_ecommerce__orders_order_channel__web__phone__social_media__ebay__newegg.4438993daa", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        order_channel as value_field,\n        count(*) as n_records\n\n    from \"ecom\".\"main\".\"stg_ecommerce__orders\"\n    group by order_channel\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'web','phone','social media','ebay','newegg'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.214934Z", "completed_at": "2026-01-26T01:20:33.217681Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.218469Z", "completed_at": "2026-01-26T01:20:33.218471Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008759021759033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.accepted_values_stg_ecommerce__orders_payment_method__credit_card__paypal__apple_pay__google_pay__ach.661cf190f6", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        payment_method as value_field,\n        count(*) as n_records\n\n    from \"ecom\".\"main\".\"stg_ecommerce__orders\"\n    group by payment_method\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'credit card','paypal','apple pay','google pay','ach'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.219850Z", "completed_at": "2026-01-26T01:20:33.224701Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.226300Z", "completed_at": "2026-01-26T01:20:33.226303Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008029937744140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.accepted_values_stg_ecommerce__orders_shipping_speed__standard__two_day__overnight.5cf8d6d610", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        shipping_speed as value_field,\n        count(*) as n_records\n\n    from \"ecom\".\"main\".\"stg_ecommerce__orders\"\n    group by shipping_speed\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'standard','two-day','overnight'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.221433Z", "completed_at": "2026-01-26T01:20:33.226567Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.227155Z", "completed_at": "2026-01-26T01:20:33.227157Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008452892303466797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__orders_actual_shipping_cost_is_null_or_actual_shipping_cost_0.da27802a8c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\n\nwhere not(actual_shipping_cost is null or actual_shipping_cost >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.223216Z", "completed_at": "2026-01-26T01:20:33.226974Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.227792Z", "completed_at": "2026-01-26T01:20:33.227794Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008173227310180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__orders_customer_id__like_CUST_or_customer_id_like_GUEST_.bcd2d2b818", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\n\nwhere not(customer_id like 'CUST-%' or customer_id like 'GUEST-%')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.224884Z", "completed_at": "2026-01-26T01:20:33.227625Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.228412Z", "completed_at": "2026-01-26T01:20:33.228414Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00718998908996582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__orders_gross_total_0.6832993948", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\n\nwhere not(gross_total >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.229054Z", "completed_at": "2026-01-26T01:20:33.233497Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.235237Z", "completed_at": "2026-01-26T01:20:33.235240Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007833719253540039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__orders_net_total_0.a61052b565", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\n\nwhere not(net_total >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.231383Z", "completed_at": "2026-01-26T01:20:33.237113Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.237506Z", "completed_at": "2026-01-26T01:20:33.237508Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00867009162902832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__orders_order_id__like_ORD_.4b7f253ff0", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\n\nwhere not(order_id like 'ORD-%')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.233845Z", "completed_at": "2026-01-26T01:20:33.237952Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.240003Z", "completed_at": "2026-01-26T01:20:33.240006Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009408950805664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__orders_payment_processing_fee_is_null_or_payment_processing_fee_0.7fce3c7109", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\n\nwhere not(payment_processing_fee is null or payment_processing_fee >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.235502Z", "completed_at": "2026-01-26T01:20:33.238317Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.240445Z", "completed_at": "2026-01-26T01:20:33.240448Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009469985961914062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__orders_shipping_cost_is_null_or_shipping_cost_0.3ec8ec0122", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\n\nwhere not(shipping_cost is null or shipping_cost >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.238490Z", "completed_at": "2026-01-26T01:20:33.241305Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.243195Z", "completed_at": "2026-01-26T01:20:33.243197Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0059051513671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__orders_total_discount_amount_is_null_or_total_discount_amount_0.6cc8fc88a2", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\n\nwhere not(total_discount_amount is null or total_discount_amount >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.241639Z", "completed_at": "2026-01-26T01:20:33.246717Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.247140Z", "completed_at": "2026-01-26T01:20:33.247142Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006897926330566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__orders_total_items_is_null_or_total_items_0.012ef0fa8a", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\n\nwhere not(total_items is null or total_items >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.245380Z", "completed_at": "2026-01-26T01:20:33.247829Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.249658Z", "completed_at": "2026-01-26T01:20:33.249660Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006665229797363281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__orders_customer_id.6654e2140c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.243988Z", "completed_at": "2026-01-26T01:20:33.249298Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.249952Z", "completed_at": "2026-01-26T01:20:33.249955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00850987434387207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__orders_batch_id.93c3f64d9c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect batch_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\nwhere batch_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.247992Z", "completed_at": "2026-01-26T01:20:33.250586Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.252597Z", "completed_at": "2026-01-26T01:20:33.252600Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005738019943237305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__orders_event_id.69734891f7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.251040Z", "completed_at": "2026-01-26T01:20:33.253618Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.257247Z", "completed_at": "2026-01-26T01:20:33.257250Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007807016372680664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__orders_gross_total.da74221586", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect gross_total\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\nwhere gross_total is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.253778Z", "completed_at": "2026-01-26T01:20:33.257932Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.259816Z", "completed_at": "2026-01-26T01:20:33.259818Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007416725158691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__orders_ingestion_ts.029b21c24a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingestion_ts\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\nwhere ingestion_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.255877Z", "completed_at": "2026-01-26T01:20:33.259651Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.260267Z", "completed_at": "2026-01-26T01:20:33.260269Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007428169250488281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__orders_net_total.faffcb9d97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect net_total\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\nwhere net_total is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.258111Z", "completed_at": "2026-01-26T01:20:33.260703Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.262578Z", "completed_at": "2026-01-26T01:20:33.262580Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006896018981933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__orders_order_date.4de8416fbb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_date\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\nwhere order_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.260870Z", "completed_at": "2026-01-26T01:20:33.263374Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.265317Z", "completed_at": "2026-01-26T01:20:33.265320Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005880117416381836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__orders_order_dt.36bcf46a7a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_dt\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\nwhere order_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.263741Z", "completed_at": "2026-01-26T01:20:33.267325Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.268601Z", "completed_at": "2026-01-26T01:20:33.268604Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00623631477355957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__orders_order_id.8c55304277", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.265576Z", "completed_at": "2026-01-26T01:20:33.268860Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.269433Z", "completed_at": "2026-01-26T01:20:33.269435Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006635904312133789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__orders_source_file.f13f472e3f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_file\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\nwhere source_file is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.267495Z", "completed_at": "2026-01-26T01:20:33.269692Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.271843Z", "completed_at": "2026-01-26T01:20:33.271844Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0067369937896728516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.orders_net_le_gross", "compiled": true, "compiled_code": "select\n  order_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\nwhere net_total > gross_total", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.269836Z", "completed_at": "2026-01-26T01:20:33.274139Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.274691Z", "completed_at": "2026-01-26T01:20:33.274694Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006324052810668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.relationships_stg_ecommerce__orders_customer_id__customer_id__ref_stg_ecommerce__customers_.5f342381a6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"ecom\".\"main\".\"stg_ecommerce__orders\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"ecom\".\"main\".\"stg_ecommerce__customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.272727Z", "completed_at": "2026-01-26T01:20:33.277393Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.279439Z", "completed_at": "2026-01-26T01:20:33.279442Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007977008819580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.unique_stg_ecommerce__orders_order_id.319f133bdd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecom\".\"main\".\"stg_ecommerce__orders\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.274965Z", "completed_at": "2026-01-26T01:20:33.280011Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.280614Z", "completed_at": "2026-01-26T01:20:33.280618Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008379936218261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__order_items_cost_price_is_null_or_cost_price_0.832f82f0bf", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\n\nwhere not(cost_price is null or cost_price >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.277819Z", "completed_at": "2026-01-26T01:20:33.280904Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.282948Z", "completed_at": "2026-01-26T01:20:33.282951Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008498191833496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__order_items_discount_amount_is_null_or_discount_amount_0.5b900a0854", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\n\nwhere not(discount_amount is null or discount_amount >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.281274Z", "completed_at": "2026-01-26T01:20:33.285317Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.285818Z", "completed_at": "2026-01-26T01:20:33.285821Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006124973297119141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__order_items_order_id__like_ORD_.b266307a1c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\n\nwhere not(order_id like 'ORD-%')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.283847Z", "completed_at": "2026-01-26T01:20:33.287855Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.290505Z", "completed_at": "2026-01-26T01:20:33.290510Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009484052658081055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__order_items_quantity_0.b6b6aa16aa", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\n\nwhere not(quantity > 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.286103Z", "completed_at": "2026-01-26T01:20:33.291248Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.291954Z", "completed_at": "2026-01-26T01:20:33.291957Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008563041687011719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__order_items_unit_price_0.2cf220fe2f", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\n\nwhere not(unit_price >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.288245Z", "completed_at": "2026-01-26T01:20:33.292248Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.294642Z", "completed_at": "2026-01-26T01:20:33.294645Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009053230285644531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_unique_combination_of_columns_stg_ecommerce__order_items_order_id__product_id.fa6d65dda5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_id, product_id\n    from \"ecom\".\"main\".\"stg_ecommerce__order_items\"\n    group by order_id, product_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.292628Z", "completed_at": "2026-01-26T01:20:33.297082Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.297647Z", "completed_at": "2026-01-26T01:20:33.297650Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006729841232299805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__order_items_batch_id.35a0a026ab", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect batch_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\nwhere batch_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.295552Z", "completed_at": "2026-01-26T01:20:33.299726Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.302496Z", "completed_at": "2026-01-26T01:20:33.302499Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01010274887084961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__order_items_event_id.9829eb2dd0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.297920Z", "completed_at": "2026-01-26T01:20:33.302979Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.303574Z", "completed_at": "2026-01-26T01:20:33.303577Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008484840393066406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__order_items_ingestion_ts.3c11faf0d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingestion_ts\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\nwhere ingestion_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.300109Z", "completed_at": "2026-01-26T01:20:33.304090Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.305978Z", "completed_at": "2026-01-26T01:20:33.305981Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008577108383178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__order_items_order_dt.d84bf3a1a2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_dt\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\nwhere order_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.304268Z", "completed_at": "2026-01-26T01:20:33.309219Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.310078Z", "completed_at": "2026-01-26T01:20:33.310081Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007330179214477539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__order_items_order_id.bb705f77b5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.306863Z", "completed_at": "2026-01-26T01:20:33.312207Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.312799Z", "completed_at": "2026-01-26T01:20:33.312802Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00898885726928711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__order_items_product_id.09d782e06d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.310497Z", "completed_at": "2026-01-26T01:20:33.314977Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.315541Z", "completed_at": "2026-01-26T01:20:33.315544Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008905887603759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__order_items_quantity.66d73032c7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.313094Z", "completed_at": "2026-01-26T01:20:33.317423Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.319648Z", "completed_at": "2026-01-26T01:20:33.319651Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009811878204345703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__order_items_source_file.05f45de11b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_file\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\nwhere source_file is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.315827Z", "completed_at": "2026-01-26T01:20:33.320139Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.320726Z", "completed_at": "2026-01-26T01:20:33.320729Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006173133850097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__order_items_unit_price.265a3d70c1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unit_price\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items\"\nwhere unit_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.317802Z", "completed_at": "2026-01-26T01:20:33.321165Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.323259Z", "completed_at": "2026-01-26T01:20:33.323262Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007950067520141602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.relationships_stg_ecommerce__order_items_order_id__order_id__ref_stg_ecommerce__orders_.6f9de3e21a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select order_id as from_field\n    from \"ecom\".\"main\".\"stg_ecommerce__order_items\"\n    where order_id is not null\n),\n\nparent as (\n    select order_id as to_field\n    from \"ecom\".\"main\".\"stg_ecommerce__orders\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.321318Z", "completed_at": "2026-01-26T01:20:33.325446Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.326027Z", "completed_at": "2026-01-26T01:20:33.326030Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006125926971435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__order_items_quarantine_invalid_reason_.61f0a26c4b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items_quarantine\"\n\nwhere not(invalid_reason <> '')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.323757Z", "completed_at": "2026-01-26T01:20:33.328824Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.330655Z", "completed_at": "2026-01-26T01:20:33.330658Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009709835052490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__order_items_quarantine_invalid_reason.17d53112c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invalid_reason\nfrom \"ecom\".\"main\".\"stg_ecommerce__order_items_quarantine\"\nwhere invalid_reason is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.326316Z", "completed_at": "2026-01-26T01:20:33.331165Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.331735Z", "completed_at": "2026-01-26T01:20:33.331738Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008228778839111328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__product_catalog_quarantine_invalid_reason_.69c2e44bb2", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__product_catalog_quarantine\"\n\nwhere not(invalid_reason <> '')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.329212Z", "completed_at": "2026-01-26T01:20:33.332242Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.334431Z", "completed_at": "2026-01-26T01:20:33.334434Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008639097213745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__product_catalog_quarantine_invalid_reason.75386a6e02", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invalid_reason\nfrom \"ecom\".\"main\".\"stg_ecommerce__product_catalog_quarantine\"\nwhere invalid_reason is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.332417Z", "completed_at": "2026-01-26T01:20:33.336823Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.337462Z", "completed_at": "2026-01-26T01:20:33.337465Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0065631866455078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__product_catalog_cost_price_is_null_or_cost_price_0.2fefe1862a", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\n\nwhere not(cost_price is null or cost_price >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.335019Z", "completed_at": "2026-01-26T01:20:33.339461Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.341400Z", "completed_at": "2026-01-26T01:20:33.341403Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009415864944458008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__product_catalog_inventory_quantity_is_null_or_inventory_quantity_0.960bfda15d", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\n\nwhere not(inventory_quantity is null or inventory_quantity >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.337748Z", "completed_at": "2026-01-26T01:20:33.341931Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.342558Z", "completed_at": "2026-01-26T01:20:33.342561Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00783991813659668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__product_catalog_unit_price_0.de01ee9dbc", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\n\nwhere not(unit_price >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.339866Z", "completed_at": "2026-01-26T01:20:33.342825Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.344856Z", "completed_at": "2026-01-26T01:20:33.344859Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007615327835083008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__product_catalog_batch_id.9e9d3315fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect batch_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\nwhere batch_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.343215Z", "completed_at": "2026-01-26T01:20:33.347184Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.347707Z", "completed_at": "2026-01-26T01:20:33.347710Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006003141403198242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__product_catalog_event_id.4da7336c79", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.345734Z", "completed_at": "2026-01-26T01:20:33.350318Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.352343Z", "completed_at": "2026-01-26T01:20:33.352346Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009360790252685547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__product_catalog_ingestion_ts.c081f63252", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingestion_ts\nfrom \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\nwhere ingestion_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.347983Z", "completed_at": "2026-01-26T01:20:33.352841Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.353514Z", "completed_at": "2026-01-26T01:20:33.353516Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008222818374633789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__product_catalog_product_id.25b088f1bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.350674Z", "completed_at": "2026-01-26T01:20:33.353805Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.355850Z", "completed_at": "2026-01-26T01:20:33.355852Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008373022079467773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__product_catalog_product_name.08d56de8dc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_name\nfrom \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\nwhere product_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.354182Z", "completed_at": "2026-01-26T01:20:33.358676Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.360928Z", "completed_at": "2026-01-26T01:20:33.360931Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0083160400390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__product_catalog_source_file.b6fdaa32f8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_file\nfrom \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\nwhere source_file is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.356728Z", "completed_at": "2026-01-26T01:20:33.361266Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.363450Z", "completed_at": "2026-01-26T01:20:33.363453Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009500980377197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__product_catalog_unit_price.5820f59b3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unit_price\nfrom \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\nwhere unit_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.358861Z", "completed_at": "2026-01-26T01:20:33.363966Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.364690Z", "completed_at": "2026-01-26T01:20:33.364692Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008402824401855469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.relationships_stg_ecommerce__cart_items_product_id__product_id__ref_stg_ecommerce__product_catalog_.a1acbc9fdc", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.361431Z", "completed_at": "2026-01-26T01:20:33.364532Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.366702Z", "completed_at": "2026-01-26T01:20:33.366704Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008248090744018555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.relationships_stg_ecommerce__order_items_product_id__product_id__ref_stg_ecommerce__product_catalog_.6399650885", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from \"ecom\".\"main\".\"stg_ecommerce__order_items\"\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.365147Z", "completed_at": "2026-01-26T01:20:33.369768Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.371607Z", "completed_at": "2026-01-26T01:20:33.371610Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007870912551879883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.unique_stg_ecommerce__product_catalog_product_id.cc973422bd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.367802Z", "completed_at": "2026-01-26T01:20:33.371873Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.374497Z", "completed_at": "2026-01-26T01:20:33.374499Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009568929672241211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__return_items_cost_price_is_null_or_cost_price_0.33d4ca665e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\n\nwhere not(cost_price is null or cost_price >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.370133Z", "completed_at": "2026-01-26T01:20:33.375362Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.377349Z", "completed_at": "2026-01-26T01:20:33.377352Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009778976440429688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__return_items_order_id__like_ORD_.6db6b6595a", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\n\nwhere not(order_id like 'ORD-%')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.372054Z", "completed_at": "2026-01-26T01:20:33.375524Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.377618Z", "completed_at": "2026-01-26T01:20:33.377621Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00825190544128418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__return_items_quantity_returned_0.ae710ebd1e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\n\nwhere not(quantity_returned > 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.375866Z", "completed_at": "2026-01-26T01:20:33.380136Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.380674Z", "completed_at": "2026-01-26T01:20:33.380677Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005958080291748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__return_items_refunded_amount_is_null_or_refunded_amount_0.ca9c9e9734", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\n\nwhere not(refunded_amount is null or refunded_amount >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.378456Z", "completed_at": "2026-01-26T01:20:33.381181Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.384345Z", "completed_at": "2026-01-26T01:20:33.384348Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008700847625732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__return_items_return_id__like_RTN_.3a0ecf75c8", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\n\nwhere not(return_id like 'RTN-%')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.382959Z", "completed_at": "2026-01-26T01:20:33.385444Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.387374Z", "completed_at": "2026-01-26T01:20:33.387376Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007114887237548828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_unique_combination_of_columns_stg_ecommerce__return_items_return_id__product_id.d65767e812", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        return_id, product_id\n    from \"ecom\".\"main\".\"stg_ecommerce__return_items\"\n    group by return_id, product_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.381343Z", "completed_at": "2026-01-26T01:20:33.385614Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.387629Z", "completed_at": "2026-01-26T01:20:33.387631Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007714748382568359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__return_items_unit_price_0.bd0a420680", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\n\nwhere not(unit_price >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.385766Z", "completed_at": "2026-01-26T01:20:33.389748Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.390317Z", "completed_at": "2026-01-26T01:20:33.390320Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005712032318115234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__return_items_batch_id.470269ca69", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect batch_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\nwhere batch_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.387922Z", "completed_at": "2026-01-26T01:20:33.390592Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.391287Z", "completed_at": "2026-01-26T01:20:33.391290Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0060710906982421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__return_items_event_id.2c69822f2d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.393023Z", "completed_at": "2026-01-26T01:20:33.395319Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.397911Z", "completed_at": "2026-01-26T01:20:33.397913Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00781702995300293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__return_items_order_id.666f2cdc7b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.391563Z", "completed_at": "2026-01-26T01:20:33.397567Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.398194Z", "completed_at": "2026-01-26T01:20:33.398196Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008297920227050781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__return_items_ingestion_ts.de96c55d0f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingestion_ts\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\nwhere ingestion_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.395493Z", "completed_at": "2026-01-26T01:20:33.400058Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.400623Z", "completed_at": "2026-01-26T01:20:33.400625Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0061550140380859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__return_items_product_id.a619697a94", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.398457Z", "completed_at": "2026-01-26T01:20:33.401083Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.401779Z", "completed_at": "2026-01-26T01:20:33.401781Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006669759750366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__return_items_quantity_returned.0ee6c09131", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity_returned\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\nwhere quantity_returned is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.402067Z", "completed_at": "2026-01-26T01:20:33.407570Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.409351Z", "completed_at": "2026-01-26T01:20:33.409354Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008951902389526367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__return_items_return_dt.4dcbe20816", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect return_dt\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\nwhere return_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.403845Z", "completed_at": "2026-01-26T01:20:33.407731Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.409619Z", "completed_at": "2026-01-26T01:20:33.409622Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008764028549194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__return_items_return_id.f3637b57b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect return_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\nwhere return_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.405937Z", "completed_at": "2026-01-26T01:20:33.409882Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.410435Z", "completed_at": "2026-01-26T01:20:33.410437Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006820201873779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__return_items_return_item_id.7319e00caf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect return_item_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\nwhere return_item_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.407896Z", "completed_at": "2026-01-26T01:20:33.411075Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.411785Z", "completed_at": "2026-01-26T01:20:33.411787Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006078958511352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__return_items_source_file.71ac8d27f8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_file\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items\"\nwhere source_file is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.413940Z", "completed_at": "2026-01-26T01:20:33.420418Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.420752Z", "completed_at": "2026-01-26T01:20:33.420755Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009890079498291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.relationships_stg_ecommerce__return_items_product_id__product_id__ref_stg_ecommerce__product_catalog_.79490679ea", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from \"ecom\".\"main\".\"stg_ecommerce__return_items\"\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from \"ecom\".\"main\".\"stg_ecommerce__product_catalog\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.412218Z", "completed_at": "2026-01-26T01:20:33.420575Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.421058Z", "completed_at": "2026-01-26T01:20:33.421061Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010383129119873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.relationships_stg_ecommerce__return_items_order_id__order_id__ref_stg_ecommerce__orders_.6f6076eccd", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select order_id as from_field\n    from \"ecom\".\"main\".\"stg_ecommerce__return_items\"\n    where order_id is not null\n),\n\nparent as (\n    select order_id as to_field\n    from \"ecom\".\"main\".\"stg_ecommerce__orders\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.416482Z", "completed_at": "2026-01-26T01:20:33.421318Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.422063Z", "completed_at": "2026-01-26T01:20:33.422066Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010065793991088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__return_items_quarantine_invalid_reason_.e6ddab639c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items_quarantine\"\n\nwhere not(invalid_reason <> '')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.418290Z", "completed_at": "2026-01-26T01:20:33.421674Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.422531Z", "completed_at": "2026-01-26T01:20:33.422533Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0063130855560302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__return_items_quarantine_invalid_reason.2603461e7c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invalid_reason\nfrom \"ecom\".\"main\".\"stg_ecommerce__return_items_quarantine\"\nwhere invalid_reason is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.423827Z", "completed_at": "2026-01-26T01:20:33.430489Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.430849Z", "completed_at": "2026-01-26T01:20:33.430852Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008545160293579102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.accepted_values_stg_ecommerce__returns_return_channel__web__phone__ebay__social_media__newegg.d6fb6341e2", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        return_channel as value_field,\n        count(*) as n_records\n\n    from \"ecom\".\"main\".\"stg_ecommerce__returns\"\n    group by return_channel\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'web','phone','ebay','social media','newegg'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.425532Z", "completed_at": "2026-01-26T01:20:33.430675Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.431356Z", "completed_at": "2026-01-26T01:20:33.431358Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008614778518676758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__returns_customer_id__like_CUST_or_customer_id_like_GUEST_.f50993c7b8", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\n\nwhere not(customer_id like 'CUST-%' or customer_id like 'GUEST-%')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.428778Z", "completed_at": "2026-01-26T01:20:33.431180Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.431971Z", "completed_at": "2026-01-26T01:20:33.431974Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006659030914306641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__returns_refunded_amount_is_null_or_refunded_amount_0.4cb257b3d3", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\n\nwhere not(refunded_amount is null or refunded_amount >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.427301Z", "completed_at": "2026-01-26T01:20:33.431608Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.432469Z", "completed_at": "2026-01-26T01:20:33.432471Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008875846862792969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__returns_order_id__like_ORD_.8540693581", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\n\nwhere not(order_id like 'ORD-%')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.434141Z", "completed_at": "2026-01-26T01:20:33.440225Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.440470Z", "completed_at": "2026-01-26T01:20:33.440473Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0077440738677978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__returns_return_id__like_RTN_.dcff6cce1d", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\n\nwhere not(return_id like 'RTN-%')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.435802Z", "completed_at": "2026-01-26T01:20:33.440739Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.441127Z", "completed_at": "2026-01-26T01:20:33.441129Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008013010025024414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__returns_batch_id.49b7cdfb65", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect batch_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\nwhere batch_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.437431Z", "completed_at": "2026-01-26T01:20:33.441396Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.442088Z", "completed_at": "2026-01-26T01:20:33.442091Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008453845977783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__returns_customer_id.7ab439d619", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.438810Z", "completed_at": "2026-01-26T01:20:33.441742Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.442526Z", "completed_at": "2026-01-26T01:20:33.442528Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008578062057495117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__returns_event_id.bac04db3ec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.443142Z", "completed_at": "2026-01-26T01:20:33.447842Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.450730Z", "completed_at": "2026-01-26T01:20:33.450734Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009207963943481445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__returns_ingestion_ts.95d2d28f9b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingestion_ts\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\nwhere ingestion_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.446111Z", "completed_at": "2026-01-26T01:20:33.451071Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.451447Z", "completed_at": "2026-01-26T01:20:33.451449Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008690834045410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__returns_order_id.8fd4bf15cc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.448025Z", "completed_at": "2026-01-26T01:20:33.451710Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.452379Z", "completed_at": "2026-01-26T01:20:33.452381Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006724119186401367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__returns_return_date.7450e69d47", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect return_date\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\nwhere return_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.449376Z", "completed_at": "2026-01-26T01:20:33.452059Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.452788Z", "completed_at": "2026-01-26T01:20:33.452791Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0069217681884765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__returns_return_dt.8633de2158", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect return_dt\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\nwhere return_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.453458Z", "completed_at": "2026-01-26T01:20:33.457699Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.461386Z", "completed_at": "2026-01-26T01:20:33.461389Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009550094604492188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__returns_return_id.a8c23ce5bd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect return_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\nwhere return_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.455822Z", "completed_at": "2026-01-26T01:20:33.461665Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.462088Z", "completed_at": "2026-01-26T01:20:33.462090Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009060144424438477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__returns_source_file.e0cb8c617e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_file\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\nwhere source_file is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.457884Z", "completed_at": "2026-01-26T01:20:33.462769Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.463474Z", "completed_at": "2026-01-26T01:20:33.463476Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008123159408569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.relationships_stg_ecommerce__return_items_return_id__return_id__ref_stg_ecommerce__returns_.75d6933727", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select return_id as from_field\n    from \"ecom\".\"main\".\"stg_ecommerce__return_items\"\n    where return_id is not null\n),\n\nparent as (\n    select return_id as to_field\n    from \"ecom\".\"main\".\"stg_ecommerce__returns\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.459653Z", "completed_at": "2026-01-26T01:20:33.463132Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.466304Z", "completed_at": "2026-01-26T01:20:33.466306Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010720014572143555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.relationships_stg_ecommerce__returns_customer_id__customer_id__ref_stg_ecommerce__customers_.cea7d5ab3f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"ecom\".\"main\".\"stg_ecommerce__returns\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"ecom\".\"main\".\"stg_ecommerce__customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.463738Z", "completed_at": "2026-01-26T01:20:33.495314Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.495867Z", "completed_at": "2026-01-26T01:20:33.495872Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03352189064025879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.relationships_stg_ecommerce__returns_order_id__order_id__ref_stg_ecommerce__orders_.f2f7386ca2", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select order_id as from_field\n    from \"ecom\".\"main\".\"stg_ecommerce__returns\"\n    where order_id is not null\n),\n\nparent as (\n    select order_id as to_field\n    from \"ecom\".\"main\".\"stg_ecommerce__orders\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.467168Z", "completed_at": "2026-01-26T01:20:33.497668Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.499443Z", "completed_at": "2026-01-26T01:20:33.499446Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.036170005798339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.unique_stg_ecommerce__returns_return_id.ec04c99ae9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    return_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns\"\nwhere return_id is not null\ngroup by return_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.496136Z", "completed_at": "2026-01-26T01:20:33.500345Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.502314Z", "completed_at": "2026-01-26T01:20:33.502317Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007462263107299805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__returns_quarantine_invalid_reason_.a01360570b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns_quarantine\"\n\nwhere not(invalid_reason <> '')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.497840Z", "completed_at": "2026-01-26T01:20:33.500514Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.502594Z", "completed_at": "2026-01-26T01:20:33.502596Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00750422477722168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__returns_quarantine_invalid_reason.d9631713d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invalid_reason\nfrom \"ecom\".\"main\".\"stg_ecommerce__returns_quarantine\"\nwhere invalid_reason is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.500861Z", "completed_at": "2026-01-26T01:20:33.504933Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.505505Z", "completed_at": "2026-01-26T01:20:33.505507Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005782127380371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__shopping_carts_cart_id__like_CART_.6c9a9c8e9e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"\n\nwhere not(cart_id like 'CART-%')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.503484Z", "completed_at": "2026-01-26T01:20:33.506322Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.509678Z", "completed_at": "2026-01-26T01:20:33.509680Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009036064147949219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__shopping_carts_cart_total_is_null_or_cart_total_0.88b974b48e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"\n\nwhere not(cart_total is null or cart_total >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.507910Z", "completed_at": "2026-01-26T01:20:33.510442Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.512398Z", "completed_at": "2026-01-26T01:20:33.512400Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007128000259399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__shopping_carts_batch_id.d5768b5d3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect batch_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"\nwhere batch_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.506497Z", "completed_at": "2026-01-26T01:20:33.512019Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.512674Z", "completed_at": "2026-01-26T01:20:33.512676Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007598876953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.dbt_utils_expression_is_true_stg_ecommerce__shopping_carts_quarantine_invalid_reason_.2b4f27a142", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"ecom\".\"main\".\"stg_ecommerce__shopping_carts_quarantine\"\n\nwhere not(invalid_reason <> '')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.510634Z", "completed_at": "2026-01-26T01:20:33.515703Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.516264Z", "completed_at": "2026-01-26T01:20:33.516266Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006808757781982422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__shopping_carts_cart_id.242b0506ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cart_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"\nwhere cart_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.513470Z", "completed_at": "2026-01-26T01:20:33.516705Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.519766Z", "completed_at": "2026-01-26T01:20:33.519770Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007597923278808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__shopping_carts_created_at.3a45fc5289", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom \"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.516870Z", "completed_at": "2026-01-26T01:20:33.522347Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.522853Z", "completed_at": "2026-01-26T01:20:33.522856Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00737309455871582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__shopping_carts_created_dt.ae2746cf13", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_dt\nfrom \"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"\nwhere created_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.518448Z", "completed_at": "2026-01-26T01:20:33.522509Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.523132Z", "completed_at": "2026-01-26T01:20:33.523134Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007300853729248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__shopping_carts_customer_id.ec4e261690", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.520870Z", "completed_at": "2026-01-26T01:20:33.524780Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.525368Z", "completed_at": "2026-01-26T01:20:33.525370Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005332231521606445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__shopping_carts_event_id.f4f95c76dc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.523408Z", "completed_at": "2026-01-26T01:20:33.526005Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.526707Z", "completed_at": "2026-01-26T01:20:33.526709Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006053924560546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__shopping_carts_ingestion_ts.07ca1e02c4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingestion_ts\nfrom \"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"\nwhere ingestion_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.527144Z", "completed_at": "2026-01-26T01:20:33.532664Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.534794Z", "completed_at": "2026-01-26T01:20:33.534798Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009201765060424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__shopping_carts_quarantine_invalid_reason.3c2e3caa42", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invalid_reason\nfrom \"ecom\".\"main\".\"stg_ecommerce__shopping_carts_quarantine\"\nwhere invalid_reason is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.528594Z", "completed_at": "2026-01-26T01:20:33.532838Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.535104Z", "completed_at": "2026-01-26T01:20:33.535107Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009312152862548828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.not_null_stg_ecommerce__shopping_carts_source_file.51bcb27bf6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_file\nfrom \"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"\nwhere source_file is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.530566Z", "completed_at": "2026-01-26T01:20:33.535396Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.535808Z", "completed_at": "2026-01-26T01:20:33.535810Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008868932723999023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.relationships_stg_ecommerce__cart_items_cart_id__cart_id__ref_stg_ecommerce__shopping_carts_.422d8f223f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select cart_id as from_field\n    from \"ecom\".\"main\".\"stg_ecommerce__cart_items\"\n    where cart_id is not null\n),\n\nparent as (\n    select cart_id as to_field\n    from \"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.533025Z", "completed_at": "2026-01-26T01:20:33.536076Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.536425Z", "completed_at": "2026-01-26T01:20:33.536427Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006083250045776367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.relationships_stg_ecommerce__shopping_carts_customer_id__customer_id__ref_stg_ecommerce__customers_.6580976c36", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"ecom\".\"main\".\"stg_ecommerce__customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-26T01:20:33.536900Z", "completed_at": "2026-01-26T01:20:33.539127Z"}, {"name": "execute", "started_at": "2026-01-26T01:20:33.539286Z", "completed_at": "2026-01-26T01:20:33.539289Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00308990478515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecom_dbt_duckdb.unique_stg_ecommerce__shopping_carts_cart_id.53551d49fe", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cart_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecom\".\"main\".\"stg_ecommerce__shopping_carts\"\nwhere cart_id is not null\ngroup by cart_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.5684082508087158, "args": {"partial_parse": false, "populate_cache": true, "print": true, "source_freshness_run_project_hooks": true, "compile": true, "require_nested_cumulative_type_params": false, "favor_state": false, "log_file_max_bytes": 10485760, "log_format_file": "debug", "introspect": true, "write_json": true, "use_colors_file": true, "project_dir": "/Users/garrettschumacher/Documents/git_repos/ecom_datalake_pipelines/dbt_duckdb", "warn_error_options": {"error": [], "warn": [], "silence": []}, "quiet": false, "empty_catalog": false, "log_path": "/private/tmp/dbt_logs", "static": false, "macro_debugging": false, "target_path": "../docs/local_only/dbt_duckdb_docs", "version_check": true, "use_colors": true, "which": "generate", "require_generic_test_arguments_property": true, "send_anonymous_usage_stats": false, "indirect_selection": "eager", "require_unique_project_resource_names": false, "defer": false, "show_all_deprecations": false, "strict_mode": false, "require_yaml_configuration_for_mf_time_spines": false, "log_level_file": "debug", "state_modified_compare_more_unrendered_values": false, "require_ref_searches_node_package_before_root": false, "profiles_dir": ".", "cache_selected_only": false, "skip_nodes_if_on_run_start_fails": false, "show_resource_report": false, "upload_to_artifacts_ingest_api": false, "validate_macro_args": false, "printer_width": 80, "use_fast_test_edges": false, "state_modified_compare_vars": false, "exclude": [], "log_level": "info", "vars": {}, "partial_parse_file_diff": true, "invocation_command": "dbt docs generate --profiles-dir .", "log_format": "default", "require_all_warnings_handled_by_warn_error": false, "static_parser": true, "select": [], "require_resource_names_without_spaces": true, "require_explicit_package_overrides_for_builtin_materializations": true, "require_batched_execution_for_custom_microbatch_strategy": false}}